import{r as v,j as E}from"./react-D9vTRhYi.js";import{c as oe}from"./classcat-RvS1aOr8.js";import{z as mn,i as $s,t as As}from"./d3-zoom-C2t-IkRF.js";import{s as Xe,p as yn}from"./d3-selection-DSeOx27A.js";import{d as xn}from"./d3-drag-CKshNLwO.js";import{u as Ps,s as ne,c as _s}from"./zustand-D0DrR9xu.js";import"./react-dom-svIPcKm3.js";const ce={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},ze=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wn=["Enter"," ","Escape"];var ye;(function(e){e.Strict="strict",e.Loose="loose"})(ye||(ye={}));var he;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(he||(he={}));var Ie;(function(e){e.Partial="partial",e.Full="full"})(Ie||(Ie={}));const En={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ue;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ue||(ue={}));var Re;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Re||(Re={}));var R;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(R||(R={}));const jt={[R.Left]:R.Right,[R.Right]:R.Left,[R.Top]:R.Bottom,[R.Bottom]:R.Top};function bn(e){return e===null?null:e?"valid":"invalid"}const vn=e=>"id"in e&&"source"in e&&"target"in e,Hs=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Sn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Pe=(e,t=[0,0])=>{const{width:n,height:o}=je(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},_e=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){const s=ut(o);n=xt(n,s)}}),wt(n)},Nn=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const c={...He(t,[n,o,s]),width:t.width/s,height:t.height/s},d=[];for(const f of e.values()){const{measured:u,selectable:a=!0,hidden:l=!1}=f;if(i&&!a||l)continue;const g=u.width??f.width??f.initialWidth??null,h=u.height??f.height??f.initialHeight??null,p=ke(c,we(f)),y=(g??0)*(h??0),x=r&&p>0;(!f.internals.handleBounds||x||p>=y||f.dragging)&&d.push(f)}return d},js=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function at(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function lt({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!1);const c=_e(e),d=Et(c,t,n,(i==null?void 0:i.minZoom)??s,(i==null?void 0:i.maxZoom)??r,(i==null?void 0:i.padding)??.1);return await o.setViewport(d,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function Ts(e,t){var n,o;return!t||t==="parent"?t:[t[0],[t[1][0]-(((n=e.measured)==null?void 0:n.width)??0),t[1][1]-(((o=e.measured)==null?void 0:o.height)??0)]]}function Cn({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),c=i.parentId?n.get(i.parentId):void 0,{x:d,y:f}=c?c.internals.positionAbsolute:{x:0,y:0},u=i.origin??o;let a=Ts(i,i.extent||s);if(i.extent==="parent"&&!i.expandParent)if(!c)r==null||r("005",ce.error005());else{const g=i.measured.width,h=i.measured.height,p=c.measured.width,y=c.measured.height;g&&h&&p&&y&&(a=[[d,f],[d+p-g,f+y-h]])}else c&&Lt(i.extent)&&(a=[[i.extent[0][0]+d,i.extent[0][1]+f],[i.extent[1][0]+d,i.extent[1][1]+f]]);const l=Lt(a)?yt(t,a):t;return{position:{x:l.x-d+i.measured.width*u[0],y:l.y-f+i.measured.height*u[1]},positionAbsolute:l}}async function Bs({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(l=>l.id)),i=[];for(const l of n){if(l.deletable===!1)continue;const g=r.has(l.id),h=!g&&l.parentId&&i.find(p=>p.id===l.parentId);(g||h)&&i.push(l)}const c=new Set(t.map(l=>l.id)),d=o.filter(l=>l.deletable!==!1),u=js(i,d);for(const l of d)c.has(l.id)&&!u.find(h=>h.id===l.id)&&u.push(l);if(!s)return{edges:u,nodes:i};const a=await s({nodes:i,edges:u});return typeof a=="boolean"?a?{edges:u,nodes:i}:{edges:[],nodes:[]}:a}const xe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),yt=(e={x:0,y:0},t)=>({x:xe(e.x,t[0][0],t[1][0]),y:xe(e.y,t[0][1],t[1][1])}),Tt=(e,t,n)=>e<t?xe(Math.abs(e-t),1,t)/t:e>n?-xe(Math.abs(e-n),1,t)/t:0,Mn=(e,t,n=15,o=40)=>{const s=Tt(e.x,o,t.width-o)*n,r=Tt(e.y,o,t.height-o)*n;return[s,r]},xt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),dt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),wt=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),we=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Sn(e)?e.internals.positionAbsolute:Pe(e,t);return{x:n,y:o,width:((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}},ut=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Sn(e)?e.internals.positionAbsolute:Pe(e,t);return{x:n,y:o,x2:n+(((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0),y2:o+(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0)}},In=(e,t)=>wt(xt(dt(e),dt(t))),ke=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Bt=e=>re(e.width)&&re(e.height)&&re(e.x)&&re(e.y),re=e=>!isNaN(e)&&isFinite(e),Ls=(e,t)=>{},We=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),He=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const c={x:(e-n)/s,y:(t-o)/s};return r?We(c,i):c},kn=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Et=(e,t,n,o,s,r)=>{const i=t/(e.width*(1+r)),c=n/(e.height*(1+r)),d=Math.min(i,c),f=xe(d,o,s),u=e.x+e.width/2,a=e.y+e.height/2,l=t/2-u*f,g=n/2-a*f;return{x:l,y:g,zoom:f}},Fe=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Lt(e){return e!==void 0&&e!=="parent"}function je(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function $n(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function An(e,t={width:0,height:0},n,o,s){let r=n;const i={...e};for(;r;){const c=o.get(r);if(r=c==null?void 0:c.parentId,c){const d=c.origin||s;i.x+=c.internals.positionAbsolute.x-(t.width??0)*d[0],i.y+=c.internals.positionAbsolute.y-(t.height??0)*d[1]}}return i}function Ce(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o}){const{x:s,y:r}=ie(e),i=He({x:s,y:r},o),{x:c,y:d}=n?We(i,t):i;return{xSnapped:c,ySnapped:d,...i}}const bt=e=>({width:e.offsetWidth,height:e.offsetHeight}),Pn=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Ds=["INPUT","SELECT","TEXTAREA"];function ft(e){var o,s;const t=((s=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:s[0])||e.target;return Ds.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const _n=e=>"clientX"in e,ie=(e,t)=>{var r,i;const n=_n(e),o=n?e.clientX:(r=e.touches)==null?void 0:r[0].clientX,s=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},Dt=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const c=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(c.left-n.left)/o,y:(c.top-n.top)/o,...bt(i)}})};function Hn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:c}){const d=e*.125+s*.375+i*.375+n*.125,f=t*.125+r*.375+c*.375+o*.125,u=Math.abs(d-e),a=Math.abs(f-t);return[d,f,u,a]}function Be(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Vt({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case R.Left:return[t-Be(t-o,r),n];case R.Right:return[t+Be(o-t,r),n];case R.Top:return[t,n-Be(n-s,r)];case R.Bottom:return[t,n+Be(s-n,r)]}}function jn({sourceX:e,sourceY:t,sourcePosition:n=R.Bottom,targetX:o,targetY:s,targetPosition:r=R.Top,curvature:i=.25}){const[c,d]=Vt({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[f,u]=Vt({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[a,l,g,h]=Hn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:d,targetControlX:f,targetControlY:u});return[`M${e},${t} C${c},${d} ${f},${u} ${o},${s}`,a,l,g,h]}function Tn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,c=o<t?o+i:o-i;return[r,c,s,i]}function Vs({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:s=!1}){if(!s)return o;const r=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return o+(r?i:0)}function zs({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=xt(ut(e),ut(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return ke(i,wt(r))>0}const Rs=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,Fs=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Ys=(e,t)=>{if(!e.source||!e.target)return t;let n;return vn(e)?n={...e}:n={...e,id:Rs(e)},Fs(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Bn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,c]=Tn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,c]}const zt={[R.Left]:{x:-1,y:0},[R.Right]:{x:1,y:0},[R.Top]:{x:0,y:-1},[R.Bottom]:{x:0,y:1}},Os=({source:e,sourcePosition:t=R.Bottom,target:n})=>t===R.Left||t===R.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Rt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Xs({source:e,sourcePosition:t=R.Bottom,target:n,targetPosition:o=R.Top,center:s,offset:r}){const i=zt[t],c=zt[o],d={x:e.x+i.x*r,y:e.y+i.y*r},f={x:n.x+c.x*r,y:n.y+c.y*r},u=Os({source:d,sourcePosition:t,target:f}),a=u.x!==0?"x":"y",l=u[a];let g=[],h,p;const y={x:0,y:0},x={x:0,y:0},[S,m,w,_]=Tn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[a]*c[a]===-1){h=s.x??S,p=s.y??m;const M=[{x:h,y:d.y},{x:h,y:f.y}],A=[{x:d.x,y:p},{x:f.x,y:p}];i[a]===l?g=a==="x"?M:A:g=a==="x"?A:M}else{const M=[{x:d.x,y:f.y}],A=[{x:f.x,y:d.y}];if(a==="x"?g=i.x===l?A:M:g=i.y===l?M:A,t===o){const N=Math.abs(e[a]-n[a]);if(N<=r){const C=Math.min(r-1,r-N);i[a]===l?y[a]=(d[a]>e[a]?-1:1)*C:x[a]=(f[a]>n[a]?-1:1)*C}}if(t!==o){const N=a==="x"?"y":"x",C=i[a]===c[N],P=d[N]>f[N],H=d[N]<f[N];(i[a]===1&&(!C&&P||C&&H)||i[a]!==1&&(!C&&H||C&&P))&&(g=a==="x"?M:A)}const $={x:d.x+y.x,y:d.y+y.y},k={x:f.x+x.x,y:f.y+x.y},B=Math.max(Math.abs($.x-g[0].x),Math.abs(k.x-g[0].x)),D=Math.max(Math.abs($.y-g[0].y),Math.abs(k.y-g[0].y));B>=D?(h=($.x+k.x)/2,p=g[0].y):(h=g[0].x,p=($.y+k.y)/2)}return[[e,{x:d.x+y.x,y:d.y+y.y},...g,{x:f.x+x.x,y:f.y+x.y},n],h,p,w,_]}function Ws(e,t,n,o){const s=Math.min(Rt(e,t)/2,Rt(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const f=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${r+s*f},${i}Q ${r},${i} ${r},${i+s*u}`}const c=e.x<n.x?1:-1,d=e.y<n.y?-1:1;return`L ${r},${i+s*d}Q ${r},${i} ${r+s*c},${i}`}function gt({sourceX:e,sourceY:t,sourcePosition:n=R.Bottom,targetX:o,targetY:s,targetPosition:r=R.Top,borderRadius:i=5,centerX:c,centerY:d,offset:f=20}){const[u,a,l,g,h]=Xs({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:c,y:d},offset:f});return[u.reduce((y,x,S)=>{let m="";return S>0&&S<u.length-1?m=Ws(u[S-1],x,u[S+1],i):m=`${S===0?"M":"L"}${x.x} ${x.y}`,y+=m,y},""),a,l,g,h]}function Ft(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Gs(e){var a;const{sourceNode:t,targetNode:n}=e;if(!Ft(t)||!Ft(n))return null;const o=t.internals.handleBounds||Yt(t.handles),s=n.internals.handleBounds||Yt(n.handles),r=Ot((o==null?void 0:o.source)??[],e.sourceHandle),i=Ot(e.connectionMode===ye.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),e.targetHandle);if(!r||!i)return(a=e.onError)==null||a.call(e,"008",ce.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const c=(r==null?void 0:r.position)||R.Bottom,d=(i==null?void 0:i.position)||R.Top,f=$e(t,r,c),u=$e(n,i,d);return{sourceX:f.x,sourceY:f.y,targetX:u.x,targetY:u.y,sourcePosition:c,targetPosition:d}}function Yt(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function $e(e,t,n=R.Left,o=!1){const s=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,r=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:c}=t??je(e);if(o)return{x:s+i/2,y:r+c/2};switch((t==null?void 0:t.position)??n){case R.Top:return{x:s+i/2,y:r};case R.Right:return{x:s+i,y:r+c/2};case R.Bottom:return{x:s+i/2,y:r+c};case R.Left:return{x:s,y:r+c/2}}}function Ot(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function ht(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function Ks(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,c)=>([c.markerStart||o,c.markerEnd||s].forEach(d=>{if(d&&typeof d=="object"){const f=ht(d,t);r.has(f)||(i.push({id:f,color:d.color||n,...d}),r.add(f))}}),i),[]).sort((i,c)=>i.id.localeCompare(c.id))}const vt={nodeOrigin:[0,0],elevateNodesOnSelect:!0,defaults:{}},Zs={...vt,checkEquality:!0};function Us(e,t,n){const o={...vt,...n};for(const s of e.values())s.parentId&&St(s,e,t,o)}function Ln(e,t,n,o){var c,d;const s={...Zs,...o},r=new Map(t);t.clear(),n.clear();const i=o!=null&&o.elevateNodesOnSelect?1e3:0;for(const f of e){let u=r.get(f.id);s.checkEquality&&f===(u==null?void 0:u.internals.userNode)||(u={...s.defaults,...f,measured:{width:(c=f.measured)==null?void 0:c.width,height:(d=f.measured)==null?void 0:d.height},internals:{positionAbsolute:Pe(f,s.nodeOrigin),handleBounds:f.measured?u==null?void 0:u.internals.handleBounds:void 0,z:Dn(f,i),userNode:f}}),t.set(f.id,u),f.parentId&&St(u,t,n,o)}}function St(e,t,n,o){const s={...vt,...o},r=e.parentId,i=t.get(r);if(!i){console.warn(`Parent node ${r} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}const c=n.get(r);c?c.set(e.id,e):n.set(r,new Map([[e.id,e]]));const d=o!=null&&o.elevateNodesOnSelect?1e3:0,{x:f,y:u,z:a}=qs(e,i,s.nodeOrigin,d),l=e.internals.positionAbsolute,g=f!==l.x||u!==l.y;(g||a!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:g?{x:f,y:u}:l,z:a})}function Dn(e,t){return(re(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function qs(e,t,n,o){const s=Pe(e,n),r=Dn(e,o),i=t.internals.z??0;return{x:t.internals.positionAbsolute.x+s.x,y:t.internals.positionAbsolute.y+s.y,z:i>r?i:r}}function Nt(e,t,n,o=[0,0]){var i;const s=[],r=new Map;for(const c of e){const d=t.get(c.parentId);if(!d)continue;const f=((i=r.get(c.parentId))==null?void 0:i.expandedRect)??we(d),u=In(f,c.rect);r.set(c.parentId,{expandedRect:u,parent:d})}return r.size>0&&r.forEach(({expandedRect:c,parent:d},f)=>{var m;const u=d.internals.positionAbsolute,a=je(d),l=d.origin??o,g=c.x<u.x?Math.round(Math.abs(u.x-c.x)):0,h=c.y<u.y?Math.round(Math.abs(u.y-c.y)):0,p=Math.max(a.width,Math.round(c.width)),y=Math.max(a.height,Math.round(c.height)),x=(p-a.width)*l[0],S=(y-a.height)*l[1];(g>0||h>0||x||S)&&(s.push({id:f,type:"position",position:{x:d.position.x-g+x,y:d.position.y-h+S}}),(m=n.get(f))==null||m.forEach(w=>{e.some(_=>_.id===w.id)||s.push({id:w.id,type:"position",position:{x:w.position.x+g,y:w.position.y+h}})})),(a.width<c.width||a.height<c.height||g||h)&&s.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:p+(g?l[0]*g-x:0),height:y+(h?l[1]*h-S:0)}})}),s}function Qs(e,t,n,o,s){const r=o==null?void 0:o.querySelector(".xyflow__viewport");let i=!1;if(!r)return{changes:[],updatedInternals:i};const c=[],d=window.getComputedStyle(r),{m22:f}=new window.DOMMatrixReadOnly(d.transform),u=[];for(const a of e.values()){const l=t.get(a.id);if(l)if(l.hidden)l.internals={...l.internals,handleBounds:void 0},i=!0;else{const g=bt(a.nodeElement),h=l.measured.width!==g.width||l.measured.height!==g.height;if(!!(g.width&&g.height&&(h||!l.internals.handleBounds||a.force))){const y=a.nodeElement.getBoundingClientRect();l.measured=g,l.internals={...l.internals,positionAbsolute:Pe(l,s),handleBounds:{source:Dt("source",a.nodeElement,y,f,l.id),target:Dt("target",a.nodeElement,y,f,l.id)}},l.parentId&&St(l,t,n,{nodeOrigin:s}),i=!0,h&&(c.push({id:l.id,type:"dimensions",dimensions:g}),l.expandParent&&l.parentId&&u.push({id:l.id,parentId:l.parentId,rect:we(l,s)}))}}}if(u.length>0){const a=Nt(u,t,n,s);c.push(...a)}return{changes:c,updatedInternals:i}}async function Js({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),c=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(c)}function Vn(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:c=null}=o,d=`${s}-source-${i}`,f=`${r}-target-${c}`,u=e.get(d)||new Map,a=e.get(f)||new Map,l={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:c};t.set(o.id,o),e.set(d,u.set(`${r}-${c}`,l)),e.set(f,a.set(`${s}-${i}`,l))}}function zn(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:zn(n,t):!1}function Xt(e,t,n){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===n)return!1;o=o.parentElement}while(o);return!1}function er(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!zn(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const c=e.get(r);c&&s.set(r,{id:r,position:c.position||{x:0,y:0},distance:{x:n.x-c.internals.positionAbsolute.x,y:n.y-c.internals.positionAbsolute.y},extent:c.extent,parentId:c.parentId,origin:c.origin,expandParent:c.expandParent,internals:{positionAbsolute:c.internals.positionAbsolute||{x:0,y:0}},measured:{width:c.measured.width??0,height:c.measured.height??0}})}return s}function ot({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,c;const s=[];for(const[d,f]of t){const u=(i=n.get(d))==null?void 0:i.internals.userNode;u&&s.push({...u,position:f.position,dragging:o})}if(!e)return[s[0],s];const r=n.get(e).internals.userNode;return[{...r,position:((c=t.get(e))==null?void 0:c.position)||r.position,dragging:o},s]}function tr({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,c=new Map,d=!1,f={x:0,y:0},u=null,a=!1,l=null,g=!1;function h({noDragClassName:y,handleSelector:x,domNode:S,isSelectable:m,nodeId:w,nodeClickDistance:_=0}){l=Xe(S);function j({x:k,y:B},D){const{nodeLookup:N,nodeExtent:C,snapGrid:P,snapToGrid:H,nodeOrigin:T,onNodeDrag:b,onSelectionDrag:I,onError:L,updateNodePositions:F}=t();r={x:k,y:B};let Y=!1,G={x:0,y:0,x2:0,y2:0};if(c.size>1&&C){const W=_e(c);G=dt(W)}for(const[W,O]of c){let X={x:k-O.distance.x,y:B-O.distance.y};H&&(X=We(X,P));let U=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(c.size>1&&C&&!O.extent){const{positionAbsolute:q}=O.internals,Z=q.x-G.x+C[0][0],V=q.x+O.measured.width-G.x2+C[1][0],J=q.y-G.y+C[0][1],ee=q.y+O.measured.height-G.y2+C[1][1];U=[[Z,J],[V,ee]]}const{position:K,positionAbsolute:z}=Cn({nodeId:W,nextPosition:X,nodeLookup:N,nodeExtent:U,nodeOrigin:T,onError:L});Y=Y||O.position.x!==K.x||O.position.y!==K.y,O.position=K,O.internals.positionAbsolute=z}if(Y&&(F(c,!0),D&&(o||b||!w&&I))){const[W,O]=ot({nodeId:w,dragItems:c,nodeLookup:N});o==null||o(D,c,W,O),b==null||b(D,W,O),w||I==null||I(D,O)}}async function M(){if(!u)return;const{transform:k,panBy:B,autoPanSpeed:D}=t(),[N,C]=Mn(f,u,D);(N!==0||C!==0)&&(r.x=(r.x??0)-N/k[2],r.y=(r.y??0)-C/k[2],await B({x:N,y:C})&&j(r,null)),i=requestAnimationFrame(M)}function A(k){var Y;const{nodeLookup:B,multiSelectionActive:D,nodesDraggable:N,transform:C,snapGrid:P,snapToGrid:H,selectNodesOnDrag:T,onNodeDragStart:b,onSelectionDragStart:I,unselectNodesAndEdges:L}=t();a=!0,(!T||!m)&&!D&&w&&((Y=B.get(w))!=null&&Y.selected||L()),m&&T&&w&&(e==null||e(w));const F=Ce(k.sourceEvent,{transform:C,snapGrid:P,snapToGrid:H});if(r=F,c=er(B,N,F,w),c.size>0&&(n||b||!w&&I)){const[G,W]=ot({nodeId:w,dragItems:c,nodeLookup:B});n==null||n(k.sourceEvent,c,G,W),b==null||b(k.sourceEvent,G,W),w||I==null||I(k.sourceEvent,W)}}const $=xn().clickDistance(_).on("start",k=>{const{domNode:B,nodeDragThreshold:D,transform:N,snapGrid:C,snapToGrid:P}=t();g=!1,D===0&&A(k),r=Ce(k.sourceEvent,{transform:N,snapGrid:C,snapToGrid:P}),u=(B==null?void 0:B.getBoundingClientRect())||null,f=ie(k.sourceEvent,u)}).on("drag",k=>{const{autoPanOnNodeDrag:B,transform:D,snapGrid:N,snapToGrid:C,nodeDragThreshold:P}=t(),H=Ce(k.sourceEvent,{transform:D,snapGrid:N,snapToGrid:C});if(k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1&&(g=!0),!g){if(!d&&B&&a&&(d=!0,M()),!a){const T=H.xSnapped-(r.x??0),b=H.ySnapped-(r.y??0);Math.sqrt(T*T+b*b)>P&&A(k)}(r.x!==H.xSnapped||r.y!==H.ySnapped)&&c&&a&&(f=ie(k.sourceEvent,u),j(H,k.sourceEvent))}}).on("end",k=>{if(!(!a||g)&&(d=!1,a=!1,cancelAnimationFrame(i),c.size>0)){const{nodeLookup:B,updateNodePositions:D,onNodeDragStop:N,onSelectionDragStop:C}=t();if(D(c,!1),s||N||!w&&C){const[P,H]=ot({nodeId:w,dragItems:c,nodeLookup:B,dragging:!1});s==null||s(k.sourceEvent,c,P,H),N==null||N(k.sourceEvent,P,H),w||C==null||C(k.sourceEvent,H)}}}).filter(k=>{const B=k.target;return!k.button&&(!y||!Xt(B,`.${y}`,S))&&(!x||Xt(B,x,S))});l.call($)}function p(){l==null||l.on(".drag",null)}return{update:h,destroy:p}}function nr(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())ke(s,we(r))>0&&o.push(r);return o}const or=250;function sr(e,t,n,o){var c,d;let s=[],r=1/0;const i=nr(e,n,t+or);for(const f of i){const u=[...((c=f.internals.handleBounds)==null?void 0:c.source)??[],...((d=f.internals.handleBounds)==null?void 0:d.target)??[]];for(const a of u){if(o.nodeId===a.nodeId&&o.type===a.type&&o.id===a.id)continue;const{x:l,y:g}=$e(f,a,a.position,!0),h=Math.sqrt(Math.pow(l-e.x,2)+Math.pow(g-e.y,2));h>t||(h<r?(s=[{...a,x:l,y:g}],r=h):h===r&&s.push({...a,x:l,y:g}))}}if(!s.length)return null;if(s.length>1){const f=o.type==="source"?"target":"source";return s.find(u=>u.type===f)??s[0]}return s[0]}function Rn(e,t,n,o,s=!1){var d;const r=o.get(e);if(!r)return null;const i=(d=r.internals.handleBounds)==null?void 0:d[t],c=(n?i==null?void 0:i.find(f=>f.id===n):i==null?void 0:i[0])??null;return c&&s?{...c,...$e(r,c,c.position,!0)}:c}function Fn(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function rr(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Yn=()=>!0;function ir(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:c,nodeLookup:d,lib:f,autoPanOnConnect:u,flowId:a,panBy:l,cancelConnection:g,onConnectStart:h,onConnect:p,onConnectEnd:y,isValidConnection:x=Yn,onReconnectEnd:S,updateConnection:m,getTransform:w,getFromHandle:_,autoPanSpeed:j}){const M=Pn(e.target);let A=0,$;const{x:k,y:B}=ie(e),D=M==null?void 0:M.elementFromPoint(k,B),N=Fn(r,D),C=c==null?void 0:c.getBoundingClientRect();if(!C||!N)return;const P=Rn(s,N,o,d);if(!P)return;let H=ie(e,C),T=!1,b=null,I=!1,L=null;function F(){if(!u||!C)return;const[z,q]=Mn(H,C,j);l({x:z,y:q}),A=requestAnimationFrame(F)}const Y={...P,nodeId:s,type:N,position:P.position},G=d.get(s),O={inProgress:!0,isValid:null,from:$e(G,Y,R.Left,!0),fromHandle:Y,fromPosition:Y.position,fromNode:G,to:H,toHandle:null,toPosition:jt[Y.position],toNode:null};m(O);let X=O;h==null||h(e,{nodeId:s,handleId:o,handleType:N});function U(z){if(!_()||!Y){K(z);return}const q=w();H=ie(z,C),$=sr(He(H,q,!1,[1,1]),n,d,Y),T||(F(),T=!0);const Z=On(z,{handle:$,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:x,doc:M,lib:f,flowId:a,nodeLookup:d});L=Z.handleDomNode,b=Z.connection,I=rr(!!$,Z.isValid);const V={...X,isValid:I,to:$&&I?kn({x:$.x,y:$.y},q):H,toHandle:Z.toHandle,toPosition:I&&Z.toHandle?Z.toHandle.position:jt[Y.position],toNode:Z.toHandle?d.get(Z.toHandle.nodeId):null};I&&$&&X.toHandle&&V.toHandle&&X.toHandle.type===V.toHandle.type&&X.toHandle.nodeId===V.toHandle.nodeId&&X.toHandle.id===V.toHandle.id&&X.to.x===V.to.x&&X.to.y===V.to.y||(m(V),X=V)}function K(z){($||L)&&b&&I&&(p==null||p(b));const{inProgress:q,...Z}=X,V={...Z,toPosition:X.toHandle?X.toPosition:null};y==null||y(z,V),r&&(S==null||S(z,V)),g(),cancelAnimationFrame(A),T=!1,I=!1,b=null,L=null,M.removeEventListener("mousemove",U),M.removeEventListener("mouseup",K),M.removeEventListener("touchmove",U),M.removeEventListener("touchend",K)}M.addEventListener("mousemove",U),M.addEventListener("mouseup",K),M.addEventListener("touchmove",U),M.addEventListener("touchend",K)}function On(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:c,flowId:d,isValidConnection:f=Yn,nodeLookup:u}){const a=r==="target",l=t?i.querySelector(`.${c}-flow__handle[data-id="${d}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:g,y:h}=ie(e),p=i.elementFromPoint(g,h),y=p!=null&&p.classList.contains(`${c}-flow__handle`)?p:l,x={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const S=Fn(void 0,y),m=y.getAttribute("data-nodeid"),w=y.getAttribute("data-handleid"),_=y.classList.contains("connectable"),j=y.classList.contains("connectableend");if(!m||!S)return x;const M={source:a?m:o,sourceHandle:a?w:s,target:a?o:m,targetHandle:a?s:w};x.connection=M;const $=_&&j&&(n===ye.Strict?a&&S==="source"||!a&&S==="target":m!==o||w!==s);x.isValid=$&&f(M),x.toHandle=Rn(m,S,w,u,!1)}return x}const pt={onPointerDown:ir,isValid:On};function cr({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=Xe(e);function r({translateExtent:c,width:d,height:f,zoomStep:u=10,pannable:a=!0,zoomable:l=!0,inversePan:g=!1}){const h=m=>{const w=n();if(m.sourceEvent.type!=="wheel"||!t)return;const _=-m.sourceEvent.deltaY*(m.sourceEvent.deltaMode===1?.05:m.sourceEvent.deltaMode?1:.002)*u,j=w[2]*Math.pow(2,_);t.scaleTo(j)};let p=[0,0];const y=m=>{(m.sourceEvent.type==="mousedown"||m.sourceEvent.type==="touchstart")&&(p=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY])},x=m=>{const w=n();if(m.sourceEvent.type!=="mousemove"&&m.sourceEvent.type!=="touchmove"||!t)return;const _=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY],j=[_[0]-p[0],_[1]-p[1]];p=_;const M=o()*Math.max(w[2],Math.log(w[2]))*(g?-1:1),A={x:w[0]-j[0]*M,y:w[1]-j[1]*M},$=[[0,0],[d,f]];t.setViewportConstrained({x:A.x,y:A.y,zoom:w[2]},$,c)},S=mn().on("start",y).on("zoom",a?x:null).on("zoom.wheel",l?h:null);s.call(S,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:yn}}const ar=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Ge=e=>({x:e.x,y:e.y,zoom:e.k}),st=({x:e,y:t,zoom:n})=>$s.translate(e,t).scale(n),pe=(e,t)=>e.target.closest(`.${t}`),Xn=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),rt=(e,t=0,n=()=>{})=>{const o=typeof t=="number"&&t>0;return o||n(),o?e.transition().duration(t).on("end",n):e},Wn=e=>{const t=e.ctrlKey&&Fe()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function lr({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:c,onPanZoom:d,onPanZoomEnd:f}){return u=>{if(pe(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const a=n.property("__zoom").k||1;if(u.ctrlKey&&i){const y=yn(u),x=Wn(u),S=a*Math.pow(2,x);o.scaleTo(n,S,y,u);return}const l=u.deltaMode===1?20:1;let g=s===he.Vertical?0:u.deltaX*l,h=s===he.Horizontal?0:u.deltaY*l;!Fe()&&u.shiftKey&&s!==he.Vertical&&(g=u.deltaY*l,h=0),o.translateBy(n,-(g/a)*r,-(h/a)*r,{internal:!0});const p=Ge(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,c==null||c(u,p)),e.isPanScrolling&&(d==null||d(u,p),e.panScrollTimeout=setTimeout(()=>{f==null||f(u,p),e.isPanScrolling=!1},150))}}function dr({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){if(!t&&o.type==="wheel"&&!o.ctrlKey||pe(o,e))return null;o.preventDefault(),n.call(this,o,s)}}function ur({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var r,i,c;if((r=o.sourceEvent)!=null&&r.internal)return;const s=Ge(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=s,((c=o.sourceEvent)==null?void 0:c.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,s))}}function fr({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{var i,c;e.usedRightMouseButton=!!(n&&Xn(t,e.mouseButton??0)),(i=r.sourceEvent)!=null&&i.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!((c=r.sourceEvent)!=null&&c.internal)&&(s==null||s(r.sourceEvent,Ge(r.transform)))}}function gr({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{var c;if(!((c=i.sourceEvent)!=null&&c.internal)&&(e.isZoomingOrPanning=!1,r&&Xn(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s&&ar(e.prevViewport,i.transform))){const d=Ge(i.transform);e.prevViewport=d,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s==null||s(i.sourceEvent,d)},n?150:0)}}}function hr({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:c,noPanClassName:d,lib:f}){return u=>{var h;const a=e||t,l=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(pe(u,`${f}-flow__node`)||pe(u,`${f}-flow__edge`)))return!0;if(!o&&!a&&!s&&!r&&!n||i||pe(u,c)&&u.type==="wheel"||pe(u,d)&&(u.type!=="wheel"||s&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((h=u.touches)==null?void 0:h.length)>1)return u.preventDefault(),!1;if(!a&&!s&&!l&&u.type==="wheel"||!o&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(o)&&!o.includes(u.button)&&u.type==="mousedown")return!1;const g=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&g}}function pr({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:s,viewport:r,onPanZoom:i,onPanZoomStart:c,onPanZoomEnd:d,onTransformChange:f,onDraggingChange:u}){const a={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},l=e.getBoundingClientRect(),g=mn().clickDistance(!re(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(s),h=Xe(e).call(g);w({x:r.x,y:r.y,zoom:xe(r.zoom,t,n)},[[0,0],[l.width,l.height]],s);const p=h.on("wheel.zoom"),y=h.on("dblclick.zoom");g.wheelDelta(Wn);function x(N,C){return h?new Promise(P=>{g==null||g.transform(rt(h,C==null?void 0:C.duration,()=>P(!0)),N)}):Promise.resolve(!1)}function S({noWheelClassName:N,noPanClassName:C,onPaneContextMenu:P,userSelectionActive:H,panOnScroll:T,panOnDrag:b,panOnScrollMode:I,panOnScrollSpeed:L,preventScrolling:F,zoomOnPinch:Y,zoomOnScroll:G,zoomOnDoubleClick:W,zoomActivationKeyPressed:O,lib:X}){H&&!a.isZoomingOrPanning&&m();const K=T&&!O&&!H?lr({zoomPanValues:a,noWheelClassName:N,d3Selection:h,d3Zoom:g,panOnScrollMode:I,panOnScrollSpeed:L,zoomOnPinch:Y,onPanZoomStart:c,onPanZoom:i,onPanZoomEnd:d}):dr({noWheelClassName:N,preventScrolling:F,d3ZoomHandler:p});if(h.on("wheel.zoom",K,{passive:!1}),!H){const q=ur({zoomPanValues:a,onDraggingChange:u,onPanZoomStart:c});g.on("start",q);const Z=fr({zoomPanValues:a,panOnDrag:b,onPaneContextMenu:!!P,onPanZoom:i,onTransformChange:f});g.on("zoom",Z);const V=gr({zoomPanValues:a,panOnDrag:b,panOnScroll:T,onPaneContextMenu:P,onPanZoomEnd:d,onDraggingChange:u});g.on("end",V)}const z=hr({zoomActivationKeyPressed:O,panOnDrag:b,zoomOnScroll:G,panOnScroll:T,zoomOnDoubleClick:W,zoomOnPinch:Y,userSelectionActive:H,noPanClassName:C,noWheelClassName:N,lib:X});g.filter(z),W?h.on("dblclick.zoom",y):h.on("dblclick.zoom",null)}function m(){g.on("zoom",null)}async function w(N,C,P){const H=st(N),T=g==null?void 0:g.constrain()(H,C,P);return T&&await x(T),new Promise(b=>b(T))}async function _(N,C){const P=st(N);return await x(P,C),new Promise(H=>H(P))}function j(N){if(h){const C=st(N),P=h.property("__zoom");(P.k!==N.zoom||P.x!==N.x||P.y!==N.y)&&(g==null||g.transform(h,C,null,{sync:!0}))}}function M(){const N=h?As(h.node()):{x:0,y:0,k:1};return{x:N.x,y:N.y,zoom:N.k}}function A(N,C){return h?new Promise(P=>{g==null||g.scaleTo(rt(h,C==null?void 0:C.duration,()=>P(!0)),N)}):Promise.resolve(!1)}function $(N,C){return h?new Promise(P=>{g==null||g.scaleBy(rt(h,C==null?void 0:C.duration,()=>P(!0)),N)}):Promise.resolve(!1)}function k(N){g==null||g.scaleExtent(N)}function B(N){g==null||g.translateExtent(N)}function D(N){const C=!re(N)||N<0?0:N;g==null||g.clickDistance(C)}return{update:S,destroy:m,setViewport:_,setViewportConstrained:w,getViewport:M,scaleTo:A,scaleBy:$,setScaleExtent:k,setTranslateExtent:B,syncViewport:j,setClickDistance:D}}var Me;(function(e){e.Line="line",e.Handle="handle"})(Me||(Me={}));function mr({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,c=n-o,d=[i>0?1:i<0?-1:0,c>0?1:c<0?-1:0];return i&&s&&(d[0]=d[0]*-1),c&&r&&(d[1]=d[1]*-1),d}function yr(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function le(e,t){return Math.max(0,t-e)}function de(e,t){return Math.max(0,e-t)}function Le(e,t,n){return Math.max(0,t-e,e-n)}function Wt(e,t){return e?!t:t}function xr(e,t,n,o,s,r,i,c){let{affectsX:d,affectsY:f}=t;const{isHorizontal:u,isVertical:a}=t,l=u&&a,{xSnapped:g,ySnapped:h}=n,{minWidth:p,maxWidth:y,minHeight:x,maxHeight:S}=o,{x:m,y:w,width:_,height:j,aspectRatio:M}=e;let A=Math.floor(u?g-e.pointerX:0),$=Math.floor(a?h-e.pointerY:0);const k=_+(d?-A:A),B=j+(f?-$:$),D=-r[0]*_,N=-r[1]*j;let C=Le(k,p,y),P=Le(B,x,S);if(i){let b=0,I=0;d&&A<0?b=le(m+A+D,i[0][0]):!d&&A>0&&(b=de(m+k+D,i[1][0])),f&&$<0?I=le(w+$+N,i[0][1]):!f&&$>0&&(I=de(w+B+N,i[1][1])),C=Math.max(C,b),P=Math.max(P,I)}if(c){let b=0,I=0;d&&A>0?b=de(m+A,c[0][0]):!d&&A<0&&(b=le(m+k,c[1][0])),f&&$>0?I=de(w+$,c[0][1]):!f&&$<0&&(I=le(w+B,c[1][1])),C=Math.max(C,b),P=Math.max(P,I)}if(s){if(u){const b=Le(k/M,x,S)*M;if(C=Math.max(C,b),i){let I=0;!d&&!f||d&&!f&&l?I=de(w+N+k/M,i[1][1])*M:I=le(w+N+(d?A:-A)/M,i[0][1])*M,C=Math.max(C,I)}if(c){let I=0;!d&&!f||d&&!f&&l?I=le(w+k/M,c[1][1])*M:I=de(w+(d?A:-A)/M,c[0][1])*M,C=Math.max(C,I)}}if(a){const b=Le(B*M,p,y)/M;if(P=Math.max(P,b),i){let I=0;!d&&!f||f&&!d&&l?I=de(m+B*M+D,i[1][0])/M:I=le(m+(f?$:-$)*M+D,i[0][0])/M,P=Math.max(P,I)}if(c){let I=0;!d&&!f||f&&!d&&l?I=le(m+B*M,c[1][0])/M:I=de(m+(f?$:-$)*M,c[0][0])/M,P=Math.max(P,I)}}}$=$+($<0?P:-P),A=A+(A<0?C:-C),s&&(l?k>B*M?$=(Wt(d,f)?-A:A)/M:A=(Wt(d,f)?-$:$)*M:u?($=A/M,f=d):(A=$*M,d=f));const H=d?m+A:m,T=f?w+$:w;return{width:_+(d?-A:A),height:j+(f?-$:$),x:r[0]*A*(d?-1:1)+H,y:r[1]*$*(f?-1:1)+T}}const Gn={width:0,height:0,x:0,y:0},wr={...Gn,pointerX:0,pointerY:0,aspectRatio:1};function Er(e){return[[0,0],[e.measured.width,e.measured.height]]}function br(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,c=n[0]*r,d=n[1]*i;return[[o-c,s-d],[o+r-c,s+i-d]]}function vr({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=Xe(e);function i({controlPosition:d,boundaries:f,keepAspectRatio:u,onResizeStart:a,onResize:l,onResizeEnd:g,shouldResize:h}){let p={...Gn},y={...wr};const x=yr(d);let S,m=[],w,_,j;const M=xn().on("start",A=>{const{nodeLookup:$,transform:k,snapGrid:B,snapToGrid:D,nodeOrigin:N}=n();if(S=$.get(t),!S)return;const{xSnapped:C,ySnapped:P}=Ce(A.sourceEvent,{transform:k,snapGrid:B,snapToGrid:D});p={width:S.measured.width??0,height:S.measured.height??0,x:S.position.x??0,y:S.position.y??0},y={...p,pointerX:C,pointerY:P,aspectRatio:p.width/p.height},w=void 0,S.parentId&&(S.extent==="parent"||S.expandParent)&&(w=$.get(S.parentId),_=w&&S.extent==="parent"?Er(w):void 0),m=[],j=void 0;for(const[H,T]of $)if(T.parentId===t&&(m.push({id:H,position:{...T.position},extent:T.extent}),T.extent==="parent"||T.expandParent)){const b=br(T,S,T.origin??N);j?j=[[Math.min(b[0][0],j[0][0]),Math.min(b[0][1],j[0][1])],[Math.max(b[1][0],j[1][0]),Math.max(b[1][1],j[1][1])]]:j=b}a==null||a(A,{...p})}).on("drag",A=>{const{transform:$,snapGrid:k,snapToGrid:B,nodeOrigin:D}=n(),N=Ce(A.sourceEvent,{transform:$,snapGrid:k,snapToGrid:B}),C=[];if(!S)return;const{x:P,y:H,width:T,height:b}=p,I={},L=S.origin??D,{width:F,height:Y,x:G,y:W}=xr(y,x,N,f,u,L,_,j),O=F!==T,X=Y!==b,U=G!==P&&O,K=W!==H&&X;if(!U&&!K&&!O&&!X)return;if((U||K||L[0]===1||L[1]===1)&&(I.x=U?G:p.x,I.y=K?W:p.y,p.x=I.x,p.y=I.y,m.length>0)){const V=G-P,J=W-H;for(const ee of m)ee.position={x:ee.position.x-V+L[0]*(F-T),y:ee.position.y-J+L[1]*(Y-b)},C.push(ee)}if((O||X)&&(I.width=O?F:p.width,I.height=X?Y:p.height,p.width=I.width,p.height=I.height),w&&S.expandParent){const V=L[0]*(I.width??0);I.x&&I.x<V&&(p.x=V,y.x=y.x-(I.x-V));const J=L[1]*(I.height??0);I.y&&I.y<J&&(p.y=J,y.y=y.y-(I.y-J))}const z=mr({width:p.width,prevWidth:T,height:p.height,prevHeight:b,affectsX:x.affectsX,affectsY:x.affectsY}),q={...p,direction:z};(h==null?void 0:h(A,q))!==!1&&(l==null||l(A,q),o(I,C))}).on("end",A=>{g==null||g(A,{...p}),s==null||s()});r.call(M)}function c(){r.on(".drag",null)}return{update:i,destroy:c}}const Ke=v.createContext(null),Sr=Ke.Provider,Kn=ce.error001();function Q(e,t){const n=v.useContext(Ke);if(n===null)throw new Error(Kn);return Ps(n,e,t)}function te(){const e=v.useContext(Ke);if(e===null)throw new Error(Kn);return v.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Gt={display:"none"},Nr={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Zn="react-flow__node-desc",Un="react-flow__edge-desc",Cr="react-flow__aria-live",Mr=e=>e.ariaLiveMessage;function Ir({rfId:e}){const t=Q(Mr);return E.jsx("div",{id:`${Cr}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Nr,children:t})}function kr({rfId:e,disableKeyboardA11y:t}){return E.jsxs(E.Fragment,{children:[E.jsxs("div",{id:`${Zn}-${e}`,style:Gt,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),E.jsx("div",{id:`${Un}-${e}`,style:Gt,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&E.jsx(Ir,{rfId:e})]})}const $r=e=>e.userSelectionActive?"none":"all";function Ct({position:e="top-left",children:t,className:n,style:o,...s}){const r=Q($r),i=`${e}`.split("-");return E.jsx("div",{className:oe(["react-flow__panel",n,...i]),style:{...o,pointerEvents:r},...s,children:t})}function Ar({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:E.jsx(Ct,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:E.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Pr=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},De=e=>e.id;function _r(e,t){return ne(e.selectedNodes.map(De),t.selectedNodes.map(De))&&ne(e.selectedEdges.map(De),t.selectedEdges.map(De))}function Hr({onSelectionChange:e}){const t=te(),{selectedNodes:n,selectedEdges:o}=Q(Pr,_r);return v.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const jr=e=>!!e.onSelectionChangeHandlers;function Tr({onSelectionChange:e}){const t=Q(jr);return e||t?E.jsx(Hr,{onSelectionChange:e}):null}const qn=[0,0],Br={x:0,y:0,zoom:1},Lr=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Kt=[...Lr,"rfId"],Dr=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Zt={translateExtent:ze,nodeOrigin:qn,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Vr(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:c,setDefaultNodesAndEdges:d,setPaneClickDistance:f}=Q(Dr,ne),u=te();v.useEffect(()=>(d(e.defaultNodes,e.defaultEdges),()=>{a.current=Zt,c()}),[]);const a=v.useRef(Zt);return v.useEffect(()=>{for(const l of Kt){const g=e[l],h=a.current[l];g!==h&&(typeof e[l]>"u"||(l==="nodes"?t(g):l==="edges"?n(g):l==="minZoom"?o(g):l==="maxZoom"?s(g):l==="translateExtent"?r(g):l==="nodeExtent"?i(g):l==="paneClickDistance"?f(g):l==="fitView"?u.setState({fitViewOnInit:g}):l==="fitViewOptions"?u.setState({fitViewOnInitOptions:g}):u.setState({[l]:g})))}a.current=e},Kt.map(l=>e[l])),null}function Ut(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function zr(e){var o;const[t,n]=v.useState(e==="system"?null:e);return v.useEffect(()=>{if(e!=="system"){n(e);return}const s=Ut(),r=()=>n(s!=null&&s.matches?"dark":"light");return r(),s==null||s.addEventListener("change",r),()=>{s==null||s.removeEventListener("change",r)}},[e]),t!==null?t:(o=Ut())!=null&&o.matches?"dark":"light"}const qt=typeof document<"u"?document:null;function Ae(e=null,t={target:qt,actInsideInputWithModifier:!0}){const[n,o]=v.useState(!1),s=v.useRef(!1),r=v.useRef(new Set([])),[i,c]=v.useMemo(()=>{if(e!==null){const f=(Array.isArray(e)?e:[e]).filter(a=>typeof a=="string").map(a=>a.split("+")),u=f.reduce((a,l)=>a.concat(...l),[]);return[f,u]}return[[],[]]},[e]);return v.useEffect(()=>{const d=(t==null?void 0:t.target)||qt;if(e!==null){const f=l=>{if(s.current=l.ctrlKey||l.metaKey||l.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&ft(l))return!1;const h=Jt(l.code,c);r.current.add(l[h]),Qt(i,r.current,!1)&&(l.preventDefault(),o(!0))},u=l=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&ft(l))return!1;const h=Jt(l.code,c);Qt(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(l[h]),l.key==="Meta"&&r.current.clear(),s.current=!1},a=()=>{r.current.clear(),o(!1)};return d==null||d.addEventListener("keydown",f),d==null||d.addEventListener("keyup",u),window.addEventListener("blur",a),window.addEventListener("contextmenu",a),()=>{d==null||d.removeEventListener("keydown",f),d==null||d.removeEventListener("keyup",u),window.removeEventListener("blur",a),window.removeEventListener("contextmenu",a)}}},[e,o]),n}function Qt(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function Jt(e,t){return t.includes(e)?"code":"key"}const Rr=()=>{const e=te();return v.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},fitView:t=>{const{nodeLookup:n,width:o,height:s,minZoom:r,maxZoom:i,panZoom:c}=e.getState(),d=at(n,t);return c?lt({nodes:d,width:o,height:s,minZoom:r,maxZoom:i,panZoom:c},t):Promise.resolve(!1)},setCenter:async(t,n,o)=>{const{width:s,height:r,maxZoom:i,panZoom:c}=e.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:i,f=s/2-t*d,u=r/2-n*d;return c?(await c.setViewport({x:f,y:u,zoom:d},{duration:o==null?void 0:o.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:c}=e.getState(),d=Et(t,o,s,r,i,(n==null?void 0:n.padding)??.1);return c?(await c.setViewport(d,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:o,snapGrid:s,domNode:r}=e.getState();if(!r)return t;const{x:i,y:c}=r.getBoundingClientRect(),d={x:t.x-i,y:t.y-c};return He(d,o,n.snapToGrid,s)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=kn(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function Qn(e,t){const n=[],o=new Map;for(const s of e)if(s.type==="add"){n.push(s.item);continue}else if(s.type==="remove"||s.type==="replace")o.set(s.id,[s]);else{const r=o.get(s.id);r?r.push(s):o.set(s.id,[s])}for(const s of t){const r=o.get(s.id);if(!r){n.push(s);continue}if(r[0].type==="remove")continue;if(r[0].type==="replace"){n.push({...r[0].item});continue}const i={...s};for(const c of r)Fr(c,i);n.push(i)}return n}function Fr(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Jn(e,t){return Qn(e,t)}function eo(e,t){return Qn(e,t)}function ge(e,t){return{id:e,type:"select",selected:t}}function me(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(ge(r.id,i)))}return o}function en({items:e=[],lookup:t}){var s;const n=[],o=new Map(e.map(r=>[r.id,r]));for(const r of e){const i=t.get(r.id),c=((s=i==null?void 0:i.internals)==null?void 0:s.userNode)??i;c!==void 0&&c!==r&&n.push({id:r.id,item:r,type:"replace"}),c===void 0&&n.push({item:r,type:"add"})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function tn(e){return{id:e.id,type:"remove"}}const nn=e=>Hs(e),Yr=e=>vn(e);function to(e){return v.forwardRef(e)}const Or=typeof window<"u"?v.useLayoutEffect:v.useEffect;function on(e){const[t,n]=v.useState(!1),[o]=v.useState(()=>Xr(()=>n(!0)));return Or(()=>{if(!t){o.reset();return}const s=o.get();s.length&&(e(s),o.reset()),n(!1)},[t]),o}function Xr(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const no=v.createContext(null);function Wr({children:e}){const t=te(),n=v.useCallback(c=>{const{nodes:d=[],setNodes:f,hasDefaultNodes:u,onNodesChange:a,nodeLookup:l}=t.getState();let g=d;for(const h of c)g=typeof h=="function"?h(g):h;u?f(g):a&&a(en({items:g,lookup:l}))},[]),o=on(n),s=v.useCallback(c=>{const{edges:d=[],setEdges:f,hasDefaultEdges:u,onEdgesChange:a,edgeLookup:l}=t.getState();let g=d;for(const h of c)g=typeof h=="function"?h(g):h;u?f(g):a&&a(en({items:g,lookup:l}))},[]),r=on(s),i=v.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return E.jsx(no.Provider,{value:i,children:e})}function Gr(){const e=v.useContext(no);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Kr=e=>!!e.panZoom;function Mt(){const e=Rr(),t=te(),n=Gr(),o=Q(Kr),s=v.useMemo(()=>{const r=a=>t.getState().nodeLookup.get(a),i=a=>{n.nodeQueue.push(a)},c=a=>{n.edgeQueue.push(a)},d=a=>{var x,S;const{nodeLookup:l,nodeOrigin:g}=t.getState(),h=nn(a)?a:l.get(a.id),p=h.parentId?An(h.position,h.measured,h.parentId,l,g):h.position,y={id:h.id,position:p,width:((x=h.measured)==null?void 0:x.width)??h.width,height:((S=h.measured)==null?void 0:S.height)??h.height,data:h.data};return we(y)},f=(a,l,g={replace:!1})=>{i(h=>h.map(p=>{if(p.id===a){const y=typeof l=="function"?l(p):l;return g.replace&&nn(y)?y:{...p,...y}}return p}))},u=(a,l,g={replace:!1})=>{c(h=>h.map(p=>{if(p.id===a){const y=typeof l=="function"?l(p):l;return g.replace&&Yr(y)?y:{...p,...y}}return p}))};return{getNodes:()=>t.getState().nodes.map(a=>({...a})),getNode:a=>{var l;return(l=r(a))==null?void 0:l.internals.userNode},getInternalNode:r,getEdges:()=>{const{edges:a=[]}=t.getState();return a.map(l=>({...l}))},getEdge:a=>t.getState().edgeLookup.get(a),setNodes:i,setEdges:c,addNodes:a=>{const l=Array.isArray(a)?a:[a];n.nodeQueue.push(g=>[...g,...l])},addEdges:a=>{const l=Array.isArray(a)?a:[a];n.edgeQueue.push(g=>[...g,...l])},toObject:()=>{const{nodes:a=[],edges:l=[],transform:g}=t.getState(),[h,p,y]=g;return{nodes:a.map(x=>({...x})),edges:l.map(x=>({...x})),viewport:{x:h,y:p,zoom:y}}},deleteElements:async({nodes:a=[],edges:l=[]})=>{const{nodes:g,edges:h,onNodesDelete:p,onEdgesDelete:y,triggerNodeChanges:x,triggerEdgeChanges:S,onDelete:m,onBeforeDelete:w}=t.getState(),{nodes:_,edges:j}=await Bs({nodesToRemove:a,edgesToRemove:l,nodes:g,edges:h,onBeforeDelete:w}),M=j.length>0,A=_.length>0;if(M){const $=j.map(tn);y==null||y(j),S($)}if(A){const $=_.map(tn);p==null||p(_),x($)}return(A||M)&&(m==null||m({nodes:_,edges:j})),{deletedNodes:_,deletedEdges:j}},getIntersectingNodes:(a,l=!0,g)=>{const h=Bt(a),p=h?a:d(a),y=g!==void 0;return p?(g||t.getState().nodes).filter(x=>{const S=t.getState().nodeLookup.get(x.id);if(S&&!h&&(x.id===a.id||!S.internals.positionAbsolute))return!1;const m=we(y?x:S),w=ke(m,p);return l&&w>0||w>=p.width*p.height}):[]},isNodeIntersecting:(a,l,g=!0)=>{const p=Bt(a)?a:d(a);if(!p)return!1;const y=ke(p,l);return g&&y>0||y>=p.width*p.height},updateNode:f,updateNodeData:(a,l,g={replace:!1})=>{f(a,h=>{const p=typeof l=="function"?l(h):l;return g.replace?{...h,data:p}:{...h,data:{...h.data,...p}}},g)},updateEdge:u,updateEdgeData:(a,l,g={replace:!1})=>{u(a,h=>{const p=typeof l=="function"?l(h):l;return g.replace?{...h,data:p}:{...h,data:{...h.data,...p}}},g)}}},[]);return v.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const sn=e=>e.selected,Zr={actInsideInputWithModifier:!1},Ur=typeof window<"u"?window:void 0;function qr({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=te(),{deleteElements:o}=Mt(),s=Ae(e,Zr),r=Ae(t,{target:Ur});v.useEffect(()=>{if(s){const{edges:i,nodes:c}=n.getState();o({nodes:c.filter(sn),edges:i.filter(sn)}),n.setState({nodesSelectionActive:!1})}},[s]),v.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function Qr(e){const t=te();v.useEffect(()=>{const n=()=>{var s,r;if(!e.current)return!1;const o=bt(e.current);(o.height===0||o.width===0)&&((r=(s=t.getState()).onError)==null||r.call(s,"004",ce.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const Ze={position:"absolute",width:"100%",height:"100%",top:0,left:0},Jr=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function ei({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=he.Free,zoomOnDoubleClick:i=!0,panOnDrag:c=!0,defaultViewport:d,translateExtent:f,minZoom:u,maxZoom:a,zoomActivationKeyCode:l,preventScrolling:g=!0,children:h,noWheelClassName:p,noPanClassName:y,onViewportChange:x,isControlledViewport:S,paneClickDistance:m}){const w=te(),_=v.useRef(null),{userSelectionActive:j,lib:M}=Q(Jr,ne),A=Ae(l),$=v.useRef();return Qr(_),v.useEffect(()=>{if(_.current){$.current=pr({domNode:_.current,minZoom:u,maxZoom:a,translateExtent:f,viewport:d,paneClickDistance:m,onTransformChange:N=>{x==null||x({x:N[0],y:N[1],zoom:N[2]}),S||w.setState({transform:N})},onDraggingChange:N=>w.setState({paneDragging:N}),onPanZoomStart:(N,C)=>{const{onViewportChangeStart:P,onMoveStart:H}=w.getState();H==null||H(N,C),P==null||P(C)},onPanZoom:(N,C)=>{const{onViewportChange:P,onMove:H}=w.getState();H==null||H(N,C),P==null||P(C)},onPanZoomEnd:(N,C)=>{const{onViewportChangeEnd:P,onMoveEnd:H}=w.getState();H==null||H(N,C),P==null||P(C)}});const{x:k,y:B,zoom:D}=$.current.getViewport();return w.setState({panZoom:$.current,transform:[k,B,D],domNode:_.current.closest(".react-flow")}),()=>{var N;(N=$.current)==null||N.destroy()}}},[]),v.useEffect(()=>{var k;(k=$.current)==null||k.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:c,zoomActivationKeyPressed:A,preventScrolling:g,noPanClassName:y,userSelectionActive:j,noWheelClassName:p,lib:M})},[e,t,n,o,s,r,i,c,A,g,y,j,p,M]),E.jsx("div",{className:"react-flow__renderer",ref:_,style:Ze,children:h})}const ti=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function ni(){const{userSelectionActive:e,userSelectionRect:t}=Q(ti,ne);return e&&t?E.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const it=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},oi=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function si({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Ie.Full,panOnDrag:o,selectionOnDrag:s,onSelectionStart:r,onSelectionEnd:i,onPaneClick:c,onPaneContextMenu:d,onPaneScroll:f,onPaneMouseEnter:u,onPaneMouseMove:a,onPaneMouseLeave:l,children:g}){const h=v.useRef(null),p=te(),y=v.useRef(0),x=v.useRef(0),S=v.useRef(),m=v.useRef(new Map),{userSelectionActive:w,elementsSelectable:_,dragging:j}=Q(oi,ne),M=_&&(e||w),A=v.useRef(!1),$=v.useRef(!1),k=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,x.current=0},B=b=>{if(A.current){A.current=!1;return}c==null||c(b),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},D=b=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){b.preventDefault();return}d==null||d(b)},N=f?b=>f(b):void 0,C=b=>{var W,O,X,U;const{resetSelectedElements:I,domNode:L,edgeLookup:F}=p.getState();if(S.current=L==null?void 0:L.getBoundingClientRect(),!_||!e||b.button!==0||b.target!==h.current||!S.current)return;(O=(W=b.target)==null?void 0:W.setPointerCapture)==null||O.call(W,b.pointerId),$.current=!0,A.current=!1,m.current=new Map;for(const[K,z]of F)m.current.set(z.source,((X=m.current.get(z.source))==null?void 0:X.add(K))||new Set([K])),m.current.set(z.target,((U=m.current.get(z.target))==null?void 0:U.add(K))||new Set([K]));const{x:Y,y:G}=ie(b.nativeEvent,S.current);I(),p.setState({userSelectionRect:{width:0,height:0,startX:Y,startY:G,x:Y,y:G}}),r==null||r(b)},P=b=>{const{userSelectionRect:I,edgeLookup:L,transform:F,nodeLookup:Y,triggerNodeChanges:G,triggerEdgeChanges:W}=p.getState();if(!S.current||!I)return;A.current=!0;const{x:O,y:X}=ie(b.nativeEvent,S.current),{startX:U,startY:K}=I,z={startX:U,startY:K,x:O<U?O:U,y:X<K?X:K,width:Math.abs(O-U),height:Math.abs(X-K)},q=Nn(Y,z,F,n===Ie.Partial,!0),Z=new Set,V=new Set;for(const J of q){V.add(J.id);const ee=m.current.get(J.id);if(ee)for(const se of ee)Z.add(se)}if(y.current!==V.size){y.current=V.size;const J=me(Y,V,!0);G(J)}if(x.current!==Z.size){x.current=Z.size;const J=me(L,Z);W(J)}p.setState({userSelectionRect:z,userSelectionActive:!0,nodesSelectionActive:!1})},H=b=>{var L,F;if(b.button!==0||!$.current)return;(F=(L=b.target)==null?void 0:L.releasePointerCapture)==null||F.call(L,b.pointerId);const{userSelectionRect:I}=p.getState();!w&&I&&b.target===h.current&&(B==null||B(b)),y.current>0&&p.setState({nodesSelectionActive:!0}),k(),i==null||i(b),(t||s)&&(A.current=!1),$.current=!1},T=o===!0||Array.isArray(o)&&o.includes(0);return E.jsxs("div",{className:oe(["react-flow__pane",{draggable:T,dragging:j,selection:e}]),onClick:M?void 0:it(B,h),onContextMenu:it(D,h),onWheel:it(N,h),onPointerEnter:M?void 0:u,onPointerDown:M?C:a,onPointerMove:M?P:a,onPointerUp:M?H:void 0,onPointerLeave:l,ref:h,style:Ze,children:[g,E.jsx(ni,{})]})}function mt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:c,onError:d}=t.getState(),f=c.get(e);if(!f){d==null||d("012",ce.error012(e));return}t.setState({nodesSelectionActive:!1}),f.selected?(n||f.selected&&i)&&(r({nodes:[f],edges:[]}),requestAnimationFrame(()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.blur()})):s([e])}function oo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const c=te(),[d,f]=v.useState(!1),u=v.useRef();return v.useEffect(()=>{u.current=tr({getStoreItems:()=>c.getState(),onNodeMouseDown:a=>{mt({id:a,store:c,nodeRef:e})},onDragStart:()=>{f(!0)},onDragStop:()=>{f(!1)}})},[]),v.useEffect(()=>{var a,l;if(t)(a=u.current)==null||a.destroy();else if(e.current)return(l=u.current)==null||l.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{var g;(g=u.current)==null||g.destroy()}},[n,o,t,r,e,s]),d}const ri=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function so(){const e=te();return v.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:c,updateNodePositions:d,nodeLookup:f,nodeOrigin:u}=e.getState(),a=new Map,l=ri(i),g=s?r[0]:5,h=s?r[1]:5,p=n.direction.x*g*n.factor,y=n.direction.y*h*n.factor;for(const[,x]of f){if(!l(x))continue;let S={x:x.internals.positionAbsolute.x+p,y:x.internals.positionAbsolute.y+y};s&&(S=We(S,r));const{position:m,positionAbsolute:w}=Cn({nodeId:x.id,nextPosition:S,nodeLookup:f,nodeExtent:o,nodeOrigin:u,onError:c});x.position=m,x.internals.positionAbsolute=w,a.set(x.id,x)}d(a)},[])}const It=v.createContext(null),ii=It.Provider;It.Consumer;const ro=()=>v.useContext(It),ci=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ai=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:c,toHandle:d,isValid:f}=i,u=(d==null?void 0:d.nodeId)===e&&(d==null?void 0:d.id)===t&&(d==null?void 0:d.type)===n;return{connectingFrom:(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n,connectingTo:u,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:r===ye.Strict?(c==null?void 0:c.type)!==n:e!==(c==null?void 0:c.nodeId)||t!==(c==null?void 0:c.id),connectionInProcess:!!c,valid:u&&f}};function li({type:e="source",position:t=R.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:c,children:d,className:f,onMouseDown:u,onTouchStart:a,...l},g){var C,P;const h=i||null,p=e==="target",y=te(),x=ro(),{connectOnClick:S,noPanClassName:m,rfId:w}=Q(ci,ne),{connectingFrom:_,connectingTo:j,clickConnecting:M,isPossibleEndHandle:A,connectionInProcess:$,valid:k}=Q(ai(x,h,e),ne);x||(P=(C=y.getState()).onError)==null||P.call(C,"010",ce.error010());const B=H=>{const{defaultEdgeOptions:T,onConnect:b,hasDefaultEdges:I}=y.getState(),L={...T,...H};if(I){const{edges:F,setEdges:Y}=y.getState();Y(Ys(L,F))}b==null||b(L),c==null||c(L)},D=H=>{if(!x)return;const T=_n(H.nativeEvent);if(s&&(T&&H.button===0||!T)){const b=y.getState();pt.onPointerDown(H.nativeEvent,{autoPanOnConnect:b.autoPanOnConnect,connectionMode:b.connectionMode,connectionRadius:b.connectionRadius,domNode:b.domNode,nodeLookup:b.nodeLookup,lib:b.lib,isTarget:p,handleId:h,nodeId:x,flowId:b.rfId,panBy:b.panBy,cancelConnection:b.cancelConnection,onConnectStart:b.onConnectStart,onConnectEnd:b.onConnectEnd,updateConnection:b.updateConnection,onConnect:B,isValidConnection:n||b.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:b.autoPanSpeed})}T?u==null||u(H):a==null||a(H)},N=H=>{const{onClickConnectStart:T,onClickConnectEnd:b,connectionClickStartHandle:I,connectionMode:L,isValidConnection:F,lib:Y,rfId:G,nodeLookup:W,connection:O}=y.getState();if(!x||!I&&!s)return;if(!I){T==null||T(H.nativeEvent,{nodeId:x,handleId:h,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:x,type:e,id:h}});return}const X=Pn(H.target),U=n||F,{connection:K,isValid:z}=pt.isValid(H.nativeEvent,{handle:{nodeId:x,id:h,type:e},connectionMode:L,fromNodeId:I.nodeId,fromHandleId:I.id||null,fromType:I.type,isValidConnection:U,flowId:G,doc:X,lib:Y,nodeLookup:W});z&&K&&B(K);const q=structuredClone(O);delete q.inProgress,q.toPosition=q.toHandle?q.toHandle.position:null,b==null||b(H,q),y.setState({connectionClickStartHandle:null})};return E.jsx("div",{"data-handleid":h,"data-nodeid":x,"data-handlepos":t,"data-id":`${w}-${x}-${h}-${e}`,className:oe(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",m,f,{source:!p,target:p,connectable:o,connectablestart:s,connectableend:r,clickconnecting:M,connectingfrom:_,connectingto:j,valid:k,connectionindicator:o&&(!$||A)&&($?r:s)}]),onMouseDown:D,onTouchStart:D,onClick:S?N:void 0,ref:g,...l,children:d})}const Ye=v.memo(to(li));function di({data:e,isConnectable:t,sourcePosition:n=R.Bottom}){return E.jsxs(E.Fragment,{children:[e==null?void 0:e.label,E.jsx(Ye,{type:"source",position:n,isConnectable:t})]})}function ui({data:e,isConnectable:t,targetPosition:n=R.Top,sourcePosition:o=R.Bottom}){return E.jsxs(E.Fragment,{children:[E.jsx(Ye,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,E.jsx(Ye,{type:"source",position:o,isConnectable:t})]})}function fi(){return null}function gi({data:e,isConnectable:t,targetPosition:n=R.Top}){return E.jsxs(E.Fragment,{children:[E.jsx(Ye,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Oe={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},rn={input:di,default:ui,output:gi,group:fi};function hi(e){var t,n,o,s;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((s=e.style)==null?void 0:s.height)}}const pi=e=>{const{width:t,height:n,x:o,y:s}=_e(e.nodeLookup,{filter:r=>!!r.selected});return{width:re(t)?t:null,height:re(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function mi({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=te(),{width:s,height:r,transformString:i,userSelectionActive:c}=Q(pi,ne),d=so(),f=v.useRef(null);if(v.useEffect(()=>{var l;n||(l=f.current)==null||l.focus({preventScroll:!0})},[n]),oo({nodeRef:f}),c||!s||!r)return null;const u=e?l=>{const g=o.getState().nodes.filter(h=>h.selected);e(l,g)}:void 0,a=l=>{Object.prototype.hasOwnProperty.call(Oe,l.key)&&d({direction:Oe[l.key],factor:l.shiftKey?4:1})};return E.jsx("div",{className:oe(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:E.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:a,style:{width:s,height:r}})})}const cn=typeof window<"u"?window:void 0,yi=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function io({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:c,deleteKeyCode:d,selectionKeyCode:f,selectionOnDrag:u,selectionMode:a,onSelectionStart:l,onSelectionEnd:g,multiSelectionKeyCode:h,panActivationKeyCode:p,zoomActivationKeyCode:y,elementsSelectable:x,zoomOnScroll:S,zoomOnPinch:m,panOnScroll:w,panOnScrollSpeed:_,panOnScrollMode:j,zoomOnDoubleClick:M,panOnDrag:A,defaultViewport:$,translateExtent:k,minZoom:B,maxZoom:D,preventScrolling:N,onSelectionContextMenu:C,noWheelClassName:P,noPanClassName:H,disableKeyboardA11y:T,onViewportChange:b,isControlledViewport:I}){const{nodesSelectionActive:L,userSelectionActive:F}=Q(yi),Y=Ae(f,{target:cn}),G=Ae(p,{target:cn}),W=G||A,O=G||w,X=u&&W!==!0,U=Y||F||X;return qr({deleteKeyCode:d,multiSelectionKeyCode:h}),E.jsx(ei,{onPaneContextMenu:r,elementsSelectable:x,zoomOnScroll:S,zoomOnPinch:m,panOnScroll:O,panOnScrollSpeed:_,panOnScrollMode:j,zoomOnDoubleClick:M,panOnDrag:!Y&&W,defaultViewport:$,translateExtent:k,minZoom:B,maxZoom:D,zoomActivationKeyCode:y,preventScrolling:N,noWheelClassName:P,noPanClassName:H,onViewportChange:b,isControlledViewport:I,paneClickDistance:c,children:E.jsxs(si,{onSelectionStart:l,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:W,isSelecting:!!U,selectionMode:a,selectionKeyPressed:Y,selectionOnDrag:X,children:[e,L&&E.jsx(mi,{onSelectionContextMenu:C,noPanClassName:H,disableKeyboardA11y:T})]})})}io.displayName="FlowRenderer";const xi=v.memo(io),wi=e=>t=>e?Nn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ei(e){return Q(v.useCallback(wi(e),[e]),ne)}const bi=e=>e.updateNodeInternals;function vi(){const e=Q(bi),[t]=v.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return v.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Si({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=te(),r=v.useRef(null),i=v.useRef(null),c=v.useRef(e.sourcePosition),d=v.useRef(e.targetPosition),f=v.useRef(t),u=n&&!!e.internals.handleBounds;return v.useEffect(()=>{r.current&&!e.hidden&&(!u||i.current!==r.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(r.current),i.current=r.current)},[u,e.hidden]),v.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),v.useEffect(()=>{if(r.current){const a=f.current!==t,l=c.current!==e.sourcePosition,g=d.current!==e.targetPosition;(a||l||g)&&(f.current=t,c.current=e.sourcePosition,d.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function Ni({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:c,elementsSelectable:d,nodesConnectable:f,nodesFocusable:u,resizeObserver:a,noDragClassName:l,noPanClassName:g,disableKeyboardA11y:h,rfId:p,nodeTypes:y,nodeExtent:x,nodeClickDistance:S,onError:m}){const{node:w,internals:_,isParent:j}=Q(z=>{const q=z.nodeLookup.get(e),Z=z.parentLookup.has(e);return{node:q,internals:q.internals,isParent:Z}},ne);let M=w.type||"default",A=(y==null?void 0:y[M])||rn[M];A===void 0&&(m==null||m("003",ce.error003(M)),M="default",A=rn.default);const $=!!(w.draggable||c&&typeof w.draggable>"u"),k=!!(w.selectable||d&&typeof w.selectable>"u"),B=!!(w.connectable||f&&typeof w.connectable>"u"),D=!!(w.focusable||u&&typeof w.focusable>"u"),N=te(),C=$n(w),P=Si({node:w,nodeType:M,hasDimensions:C,resizeObserver:a}),H=oo({nodeRef:P,disabled:w.hidden||!$,noDragClassName:l,handleSelector:w.dragHandle,nodeId:e,isSelectable:k,nodeClickDistance:S}),T=so();if(w.hidden)return null;const b=je(w),I=hi(w),L=x?yt(_.positionAbsolute,x):_.positionAbsolute,F=k||$||t||n||o||s,Y=n?z=>n(z,{..._.userNode}):void 0,G=o?z=>o(z,{..._.userNode}):void 0,W=s?z=>s(z,{..._.userNode}):void 0,O=r?z=>r(z,{..._.userNode}):void 0,X=i?z=>i(z,{..._.userNode}):void 0,U=z=>{const{selectNodesOnDrag:q,nodeDragThreshold:Z}=N.getState();k&&(!q||!$||Z>0)&&mt({id:e,store:N,nodeRef:P}),t&&t(z,{..._.userNode})},K=z=>{if(!(ft(z.nativeEvent)||h))if(wn.includes(z.key)&&k){const q=z.key==="Escape";mt({id:e,store:N,unselect:q,nodeRef:P})}else $&&w.selected&&Object.prototype.hasOwnProperty.call(Oe,z.key)&&(N.setState({ariaLiveMessage:`Moved selected node ${z.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~L.x}, y: ${~~L.y}`}),T({direction:Oe[z.key],factor:z.shiftKey?4:1}))};return E.jsx("div",{className:oe(["react-flow__node",`react-flow__node-${M}`,{[g]:$},w.className,{selected:w.selected,selectable:k,parent:j,draggable:$,dragging:H}]),ref:P,style:{zIndex:_.z,transform:`translate(${L.x}px,${L.y}px)`,pointerEvents:F?"all":"none",visibility:C?"visible":"hidden",...w.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:Y,onMouseMove:G,onMouseLeave:W,onContextMenu:O,onClick:U,onDoubleClick:X,onKeyDown:D?K:void 0,tabIndex:D?0:void 0,role:D?"button":void 0,"aria-describedby":h?void 0:`${Zn}-${p}`,"aria-label":w.ariaLabel,children:E.jsx(ii,{value:e,children:E.jsx(A,{id:e,data:w.data,type:M,positionAbsoluteX:L.x,positionAbsoluteY:L.y,selected:w.selected,selectable:k,draggable:$,deletable:w.deletable??!0,isConnectable:B,sourcePosition:w.sourcePosition,targetPosition:w.targetPosition,dragging:H,dragHandle:w.dragHandle,zIndex:_.z,parentId:w.parentId,...b})})})}const Ci=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function co(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=Q(Ci,ne),i=Ei(e.onlyRenderVisibleElements),c=vi();return E.jsx("div",{className:"react-flow__nodes",style:Ze,children:i.map(d=>E.jsx(Ni,{id:d,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},d))})}co.displayName="NodeRenderer";const Mi=v.memo(co);function Ii(e){return Q(v.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&zs({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),ne)}const ki=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),$i=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),an={[Re.Arrow]:ki,[Re.ArrowClosed]:$i};function Ai(e){const t=te();return v.useMemo(()=>{var s,r;return Object.prototype.hasOwnProperty.call(an,e)?an[e]:((r=(s=t.getState()).onError)==null||r.call(s,"009",ce.error009(e)),null)},[e])}const Pi=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:c="auto-start-reverse"})=>{const d=Ai(t);return d?E.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:c,refX:"0",refY:"0",children:E.jsx(d,{color:n,strokeWidth:i})}):null},ao=({defaultColor:e,rfId:t})=>{const n=Q(r=>r.edges),o=Q(r=>r.defaultEdgeOptions),s=v.useMemo(()=>Ks(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return s.length?E.jsx("svg",{className:"react-flow__marker",children:E.jsx("defs",{children:s.map(r=>E.jsx(Pi,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};ao.displayName="MarkerDefinitions";var _i=v.memo(ao);function lo({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:r={},labelBgPadding:i=[2,4],labelBgBorderRadius:c=2,children:d,className:f,...u}){const[a,l]=v.useState({x:1,y:0,width:0,height:0}),g=oe(["react-flow__edge-textwrapper",f]),h=v.useRef(null);return v.useEffect(()=>{if(h.current){const p=h.current.getBBox();l({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:E.jsxs("g",{transform:`translate(${e-a.width/2} ${t-a.height/2})`,className:g,visibility:a.width?"visible":"hidden",...u,children:[s&&E.jsx("rect",{width:a.width+2*i[0],x:-i[0],y:-i[1],height:a.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:c,ry:c}),E.jsx("text",{className:"react-flow__edge-text",y:a.height/2,dy:"0.3em",ref:h,style:o,children:n}),d]})}lo.displayName="EdgeText";const Hi=v.memo(lo);function Ue({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:a,markerStart:l,className:g,interactionWidth:h=20}){return E.jsxs(E.Fragment,{children:[E.jsx("path",{id:e,style:u,d:t,fill:"none",className:oe(["react-flow__edge-path",g]),markerEnd:a,markerStart:l}),h&&E.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&re(n)&&re(o)?E.jsx(Hi,{x:n,y:o,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f}):null]})}function ln({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===R.Left||e===R.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function uo({sourceX:e,sourceY:t,sourcePosition:n=R.Bottom,targetX:o,targetY:s,targetPosition:r=R.Top}){const[i,c]=ln({pos:n,x1:e,y1:t,x2:o,y2:s}),[d,f]=ln({pos:r,x1:o,y1:s,x2:e,y2:t}),[u,a,l,g]=Hn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:c,targetControlX:d,targetControlY:f});return[`M${e},${t} C${i},${c} ${d},${f} ${o},${s}`,u,a,l,g]}function fo(e){return v.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=R.Bottom,targetPosition:c=R.Top,label:d,labelStyle:f,labelShowBg:u,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:g,style:h,markerEnd:p,markerStart:y,interactionWidth:x})=>{const[S,m,w]=uo({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c}),_=e.isInternal?void 0:t;return E.jsx(Ue,{id:_,path:S,labelX:m,labelY:w,label:d,labelStyle:f,labelShowBg:u,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:g,style:h,markerEnd:p,markerStart:y,interactionWidth:x})})}const ji=fo({isInternal:!1}),go=fo({isInternal:!0});ji.displayName="SimpleBezierEdge";go.displayName="SimpleBezierEdgeInternal";function ho(e){return v.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:a,style:l,sourcePosition:g=R.Bottom,targetPosition:h=R.Top,markerEnd:p,markerStart:y,pathOptions:x,interactionWidth:S})=>{const[m,w,_]=gt({sourceX:n,sourceY:o,sourcePosition:g,targetX:s,targetY:r,targetPosition:h,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset}),j=e.isInternal?void 0:t;return E.jsx(Ue,{id:j,path:m,labelX:w,labelY:_,label:i,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:a,style:l,markerEnd:p,markerStart:y,interactionWidth:S})})}const po=ho({isInternal:!1}),mo=ho({isInternal:!0});po.displayName="SmoothStepEdge";mo.displayName="SmoothStepEdgeInternal";function yo(e){return v.memo(({id:t,...n})=>{var s;const o=e.isInternal?void 0:t;return E.jsx(po,{...n,id:o,pathOptions:v.useMemo(()=>{var r;return{borderRadius:0,offset:(r=n.pathOptions)==null?void 0:r.offset}},[(s=n.pathOptions)==null?void 0:s.offset])})})}const Ti=yo({isInternal:!1}),xo=yo({isInternal:!0});Ti.displayName="StepEdge";xo.displayName="StepEdgeInternal";function wo(e){return v.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:a,style:l,markerEnd:g,markerStart:h,interactionWidth:p})=>{const[y,x,S]=Bn({sourceX:n,sourceY:o,targetX:s,targetY:r}),m=e.isInternal?void 0:t;return E.jsx(Ue,{id:m,path:y,labelX:x,labelY:S,label:i,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:a,style:l,markerEnd:g,markerStart:h,interactionWidth:p})})}const Bi=wo({isInternal:!1}),Eo=wo({isInternal:!0});Bi.displayName="StraightEdge";Eo.displayName="StraightEdgeInternal";function bo(e){return v.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=R.Bottom,targetPosition:c=R.Top,label:d,labelStyle:f,labelShowBg:u,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:g,style:h,markerEnd:p,markerStart:y,pathOptions:x,interactionWidth:S})=>{const[m,w,_]=jn({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c,curvature:x==null?void 0:x.curvature}),j=e.isInternal?void 0:t;return E.jsx(Ue,{id:j,path:m,labelX:w,labelY:_,label:d,labelStyle:f,labelShowBg:u,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:g,style:h,markerEnd:p,markerStart:y,interactionWidth:S})})}const Li=bo({isInternal:!1}),vo=bo({isInternal:!0});Li.displayName="BezierEdge";vo.displayName="BezierEdgeInternal";const dn={default:vo,straight:Eo,step:xo,smoothstep:mo,simplebezier:go},un={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Di=(e,t,n)=>n===R.Left?e-t:n===R.Right?e+t:e,Vi=(e,t,n)=>n===R.Top?e-t:n===R.Bottom?e+t:e,fn="react-flow__edgeupdater";function gn({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:c}){return E.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:oe([fn,`${fn}-${c}`]),cx:Di(t,o,e),cy:Vi(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function zi({isReconnectable:e,reconnectRadius:t,edge:n,targetHandleId:o,sourceHandleId:s,sourceX:r,sourceY:i,targetX:c,targetY:d,sourcePosition:f,targetPosition:u,onReconnect:a,onReconnectStart:l,onReconnectEnd:g,setReconnecting:h,setUpdateHover:p}){const y=te(),x=(j,M)=>{if(j.button!==0)return;const{autoPanOnConnect:A,domNode:$,isValidConnection:k,connectionMode:B,connectionRadius:D,lib:N,onConnectStart:C,onConnectEnd:P,cancelConnection:H,nodeLookup:T,rfId:b,panBy:I,updateConnection:L}=y.getState(),F=M?n.target:n.source,Y=(M?o:s)||null,G=M?"target":"source",W=M;h(!0),l==null||l(j,n,G);const O=(U,K)=>{h(!1),g==null||g(U,n,G,K)},X=U=>a==null?void 0:a(n,U);pt.onPointerDown(j.nativeEvent,{autoPanOnConnect:A,connectionMode:B,connectionRadius:D,domNode:$,handleId:Y,nodeId:F,nodeLookup:T,isTarget:W,edgeUpdaterType:G,lib:N,flowId:b,cancelConnection:H,panBy:I,isValidConnection:k,onConnect:X,onConnectStart:C,onConnectEnd:P,onReconnectEnd:O,updateConnection:L,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},S=j=>x(j,!0),m=j=>x(j,!1),w=()=>p(!0),_=()=>p(!1);return E.jsxs(E.Fragment,{children:[(e==="source"||e===!0)&&E.jsx(gn,{position:f,centerX:r,centerY:i,radius:t,onMouseDown:S,onMouseEnter:w,onMouseOut:_,type:"source"}),(e==="target"||e===!0)&&E.jsx(gn,{position:u,centerX:c,centerY:d,radius:t,onMouseDown:m,onMouseEnter:w,onMouseOut:_,type:"target"})]})}function Ri({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:c,onMouseMove:d,onMouseLeave:f,reconnectRadius:u,onReconnect:a,onReconnectStart:l,onReconnectEnd:g,rfId:h,edgeTypes:p,noPanClassName:y,onError:x,disableKeyboardA11y:S}){let m=Q(V=>V.edgeLookup.get(e));const w=Q(V=>V.defaultEdgeOptions);m=w?{...w,...m}:m;let _=m.type||"default",j=(p==null?void 0:p[_])||dn[_];j===void 0&&(x==null||x("011",ce.error011(_)),_="default",j=dn.default);const M=!!(m.focusable||t&&typeof m.focusable>"u"),A=typeof a<"u"&&(m.reconnectable||n&&typeof m.reconnectable>"u"),$=!!(m.selectable||o&&typeof m.selectable>"u"),k=v.useRef(null),[B,D]=v.useState(!1),[N,C]=v.useState(!1),P=te(),{zIndex:H,sourceX:T,sourceY:b,targetX:I,targetY:L,sourcePosition:F,targetPosition:Y}=Q(v.useCallback(V=>{const J=V.nodeLookup.get(m.source),ee=V.nodeLookup.get(m.target);if(!J||!ee)return{zIndex:m.zIndex,...un};const se=Gs({id:e,sourceNode:J,targetNode:ee,sourceHandle:m.sourceHandle||null,targetHandle:m.targetHandle||null,connectionMode:V.connectionMode,onError:x});return{zIndex:Vs({selected:m.selected,zIndex:m.zIndex,sourceNode:J,targetNode:ee,elevateOnSelect:V.elevateEdgesOnSelect}),...se||un}},[m.source,m.target,m.sourceHandle,m.targetHandle,m.selected,m.zIndex]),ne),G=v.useMemo(()=>m.markerStart?`url('#${ht(m.markerStart,h)}')`:void 0,[m.markerStart,h]),W=v.useMemo(()=>m.markerEnd?`url('#${ht(m.markerEnd,h)}')`:void 0,[m.markerEnd,h]);if(m.hidden||T===null||b===null||I===null||L===null)return null;const O=V=>{var ae;const{addSelectedEdges:J,unselectNodesAndEdges:ee,multiSelectionActive:se}=P.getState();$&&(P.setState({nodesSelectionActive:!1}),m.selected&&se?(ee({nodes:[],edges:[m]}),(ae=k.current)==null||ae.blur()):J([e])),s&&s(V,m)},X=r?V=>{r(V,{...m})}:void 0,U=i?V=>{i(V,{...m})}:void 0,K=c?V=>{c(V,{...m})}:void 0,z=d?V=>{d(V,{...m})}:void 0,q=f?V=>{f(V,{...m})}:void 0,Z=V=>{var J;if(!S&&wn.includes(V.key)&&$){const{unselectNodesAndEdges:ee,addSelectedEdges:se}=P.getState();V.key==="Escape"?((J=k.current)==null||J.blur(),ee({edges:[m]})):se([e])}};return E.jsx("svg",{style:{zIndex:H},children:E.jsxs("g",{className:oe(["react-flow__edge",`react-flow__edge-${_}`,m.className,y,{selected:m.selected,animated:m.animated,inactive:!$&&!s,updating:B,selectable:$}]),onClick:O,onDoubleClick:X,onContextMenu:U,onMouseEnter:K,onMouseMove:z,onMouseLeave:q,onKeyDown:M?Z:void 0,tabIndex:M?0:void 0,role:M?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":m.ariaLabel===null?void 0:m.ariaLabel||`Edge from ${m.source} to ${m.target}`,"aria-describedby":M?`${Un}-${h}`:void 0,ref:k,children:[!N&&E.jsx(j,{id:e,source:m.source,target:m.target,type:m.type,selected:m.selected,animated:m.animated,selectable:$,deletable:m.deletable??!0,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,sourceX:T,sourceY:b,targetX:I,targetY:L,sourcePosition:F,targetPosition:Y,data:m.data,style:m.style,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerStart:G,markerEnd:W,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth}),A&&E.jsx(zi,{edge:m,isReconnectable:A,reconnectRadius:u,onReconnect:a,onReconnectStart:l,onReconnectEnd:g,sourceX:T,sourceY:b,targetX:I,targetY:L,sourcePosition:F,targetPosition:Y,setUpdateHover:D,setReconnecting:C,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle})]})})}const Fi=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function So({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:c,onEdgeMouseMove:d,onEdgeMouseLeave:f,onEdgeClick:u,reconnectRadius:a,onEdgeDoubleClick:l,onReconnectStart:g,onReconnectEnd:h,disableKeyboardA11y:p}){const{edgesFocusable:y,edgesReconnectable:x,elementsSelectable:S,onError:m}=Q(Fi,ne),w=Ii(t);return E.jsxs("div",{className:"react-flow__edges",children:[E.jsx(_i,{defaultColor:e,rfId:n}),w.map(_=>E.jsx(Ri,{id:_,edgesFocusable:y,edgesReconnectable:x,elementsSelectable:S,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:c,onMouseMove:d,onMouseLeave:f,onClick:u,reconnectRadius:a,onDoubleClick:l,onReconnectStart:g,onReconnectEnd:h,rfId:n,onError:m,edgeTypes:o,disableKeyboardA11y:p},_))]})}So.displayName="EdgeRenderer";const Yi=v.memo(So),Oi=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Xi({children:e}){const t=Q(Oi);return E.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Wi(e){const t=Mt(),n=v.useRef(!1);v.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Gi=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Ki(e){const t=Q(Gi),n=te();return v.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Zi(e){return e.connection.inProgress?{...e.connection,to:He(e.connection.to,e.transform)}:{...e.connection}}function Ui(e){return Zi}function qi(e){const t=Ui();return Q(t,ne)}const Qi=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ji({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:c,inProgress:d}=Q(Qi,ne);return!(r&&s&&d)?null:E.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:E.jsx("g",{className:oe(["react-flow__connection",bn(c)]),children:E.jsx(No,{style:t,type:n,CustomComponent:o,isValid:c})})})}const No=({style:e,type:t=ue.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:c,fromPosition:d,to:f,toNode:u,toHandle:a,toPosition:l}=qi();if(!s)return;if(n)return E.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:c,fromX:r.x,fromY:r.y,toX:f.x,toY:f.y,fromPosition:d,toPosition:l,connectionStatus:bn(o),toNode:u,toHandle:a});let g="";const h={sourceX:r.x,sourceY:r.y,sourcePosition:d,targetX:f.x,targetY:f.y,targetPosition:l};switch(t){case ue.Bezier:[g]=jn(h);break;case ue.SimpleBezier:[g]=uo(h);break;case ue.Step:[g]=gt({...h,borderRadius:0});break;case ue.SmoothStep:[g]=gt(h);break;default:[g]=Bn(h)}return E.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};No.displayName="ConnectionLine";const ec={};function hn(e=ec){v.useRef(e),te(),v.useEffect(()=>{},[e])}function tc(){te(),v.useRef(!1),v.useEffect(()=>{},[])}function Co({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:u,onSelectionContextMenu:a,onSelectionStart:l,onSelectionEnd:g,connectionLineType:h,connectionLineStyle:p,connectionLineComponent:y,connectionLineContainerStyle:x,selectionKeyCode:S,selectionOnDrag:m,selectionMode:w,multiSelectionKeyCode:_,panActivationKeyCode:j,zoomActivationKeyCode:M,deleteKeyCode:A,onlyRenderVisibleElements:$,elementsSelectable:k,defaultViewport:B,translateExtent:D,minZoom:N,maxZoom:C,preventScrolling:P,defaultMarkerColor:H,zoomOnScroll:T,zoomOnPinch:b,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:F,zoomOnDoubleClick:Y,panOnDrag:G,onPaneClick:W,onPaneMouseEnter:O,onPaneMouseMove:X,onPaneMouseLeave:U,onPaneScroll:K,onPaneContextMenu:z,paneClickDistance:q,nodeClickDistance:Z,onEdgeContextMenu:V,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:se,reconnectRadius:ae,onReconnect:qe,onReconnectStart:Qe,onReconnectEnd:Je,noDragClassName:Ee,noWheelClassName:et,noPanClassName:be,disableKeyboardA11y:ve,nodeExtent:tt,rfId:Se,viewport:Ne,onViewportChange:Te}){return hn(e),hn(t),tc(),Wi(n),Ki(Ne),E.jsx(xi,{onPaneClick:W,onPaneMouseEnter:O,onPaneMouseMove:X,onPaneMouseLeave:U,onPaneContextMenu:z,onPaneScroll:K,paneClickDistance:q,deleteKeyCode:A,selectionKeyCode:S,selectionOnDrag:m,selectionMode:w,onSelectionStart:l,onSelectionEnd:g,multiSelectionKeyCode:_,panActivationKeyCode:j,zoomActivationKeyCode:M,elementsSelectable:k,zoomOnScroll:T,zoomOnPinch:b,zoomOnDoubleClick:Y,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:F,panOnDrag:G,defaultViewport:B,translateExtent:D,minZoom:N,maxZoom:C,onSelectionContextMenu:a,preventScrolling:P,noDragClassName:Ee,noWheelClassName:et,noPanClassName:be,disableKeyboardA11y:ve,onViewportChange:Te,isControlledViewport:!!Ne,children:E.jsxs(Xi,{children:[E.jsx(Yi,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:qe,onReconnectStart:Qe,onReconnectEnd:Je,onlyRenderVisibleElements:$,onEdgeContextMenu:V,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:se,reconnectRadius:ae,defaultMarkerColor:H,noPanClassName:be,disableKeyboardA11y:ve,rfId:Se}),E.jsx(Ji,{style:p,type:h,component:y,containerStyle:x}),E.jsx("div",{className:"react-flow__edgelabel-renderer"}),E.jsx(Mi,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:u,nodeClickDistance:Z,onlyRenderVisibleElements:$,noPanClassName:be,noDragClassName:Ee,disableKeyboardA11y:ve,nodeExtent:tt,rfId:Se}),E.jsx("div",{className:"react-flow__viewport-portal"})]})})}Co.displayName="GraphView";const nc=v.memo(Co),pn=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,nodeOrigin:c}={})=>{const d=new Map,f=new Map,u=new Map,a=new Map,l=o??t??[],g=n??e??[],h=c??[0,0];Vn(u,a,l),Ln(g,d,f,{nodeOrigin:h,elevateNodesOnSelect:!1});let p=[0,0,1];if(i&&s&&r){const y=_e(d,{filter:w=>!!((w.width||w.initialWidth)&&(w.height||w.initialHeight))}),{x,y:S,zoom:m}=Et(y,s,r,.5,2,.1);p=[x,S,m]}return{rfId:"1",width:0,height:0,transform:p,nodes:g,nodeLookup:d,parentLookup:f,edges:l,edgeLookup:a,connectionLookup:u,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:ze,nodeExtent:ze,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:ye.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:h,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...En},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Ls,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},oc=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,nodeOrigin:c})=>_s((d,f)=>({...pn({nodes:e,edges:t,width:s,height:r,fitView:i,nodeOrigin:c,defaultNodes:n,defaultEdges:o}),setNodes:u=>{const{nodeLookup:a,parentLookup:l,nodeOrigin:g,elevateNodesOnSelect:h}=f();Ln(u,a,l,{nodeOrigin:g,elevateNodesOnSelect:h,checkEquality:!0}),d({nodes:u})},setEdges:u=>{const{connectionLookup:a,edgeLookup:l}=f();Vn(a,l,u),d({edges:u})},setDefaultNodesAndEdges:(u,a)=>{if(u){const{setNodes:l}=f();l(u),d({hasDefaultNodes:!0})}if(a){const{setEdges:l}=f();l(a),d({hasDefaultEdges:!0})}},updateNodeInternals:(u,a={triggerFitView:!0})=>{const{triggerNodeChanges:l,nodeLookup:g,parentLookup:h,fitViewOnInit:p,fitViewDone:y,fitViewOnInitOptions:x,domNode:S,nodeOrigin:m,debug:w,fitViewSync:_}=f(),{changes:j,updatedInternals:M}=Qs(u,g,h,S,m);if(M){if(Us(g,h,{nodeOrigin:m}),a.triggerFitView){let A=y;!y&&p&&(A=_({...x,nodes:x==null?void 0:x.nodes})),d({fitViewDone:A})}else d({});(j==null?void 0:j.length)>0&&(w&&console.log("React Flow: trigger node changes",j),l==null||l(j))}},updateNodePositions:(u,a=!1)=>{const l=[],g=[];for(const[h,p]of u){const y={id:h,type:"position",position:p.position,dragging:a};p!=null&&p.expandParent&&(p!=null&&p.parentId)&&y.position&&(l.push({id:h,parentId:p.parentId,rect:{...p.internals.positionAbsolute,width:p.measured.width,height:p.measured.height}}),y.position.x=Math.max(0,y.position.x),y.position.y=Math.max(0,y.position.y)),g.push(y)}if(l.length>0){const{nodeLookup:h,parentLookup:p,nodeOrigin:y}=f(),x=Nt(l,h,p,y);g.push(...x)}f().triggerNodeChanges(g)},triggerNodeChanges:u=>{const{onNodesChange:a,setNodes:l,nodes:g,hasDefaultNodes:h,debug:p}=f();if(u!=null&&u.length){if(h){const y=Jn(u,g);l(y)}p&&console.log("React Flow: trigger node changes",u),a==null||a(u)}},triggerEdgeChanges:u=>{const{onEdgesChange:a,setEdges:l,edges:g,hasDefaultEdges:h,debug:p}=f();if(u!=null&&u.length){if(h){const y=eo(u,g);l(y)}p&&console.log("React Flow: trigger edge changes",u),a==null||a(u)}},addSelectedNodes:u=>{const{multiSelectionActive:a,edgeLookup:l,nodeLookup:g,triggerNodeChanges:h,triggerEdgeChanges:p}=f();if(a){const y=u.map(x=>ge(x,!0));h(y);return}h(me(g,new Set([...u]),!0)),p(me(l))},addSelectedEdges:u=>{const{multiSelectionActive:a,edgeLookup:l,nodeLookup:g,triggerNodeChanges:h,triggerEdgeChanges:p}=f();if(a){const y=u.map(x=>ge(x,!0));p(y);return}p(me(l,new Set([...u]))),h(me(g,new Set,!0))},unselectNodesAndEdges:({nodes:u,edges:a}={})=>{const{edges:l,nodes:g,triggerNodeChanges:h,triggerEdgeChanges:p}=f(),y=u||g,x=a||l,S=y.map(w=>(w.selected=!1,ge(w.id,!1))),m=x.map(w=>ge(w.id,!1));h(S),p(m)},setMinZoom:u=>{const{panZoom:a,maxZoom:l}=f();a==null||a.setScaleExtent([u,l]),d({minZoom:u})},setMaxZoom:u=>{const{panZoom:a,minZoom:l}=f();a==null||a.setScaleExtent([l,u]),d({maxZoom:u})},setTranslateExtent:u=>{var a;(a=f().panZoom)==null||a.setTranslateExtent(u),d({translateExtent:u})},setPaneClickDistance:u=>{var a;(a=f().panZoom)==null||a.setClickDistance(u)},resetSelectedElements:()=>{const{edges:u,nodes:a,triggerNodeChanges:l,triggerEdgeChanges:g}=f(),h=a.reduce((y,x)=>x.selected?[...y,ge(x.id,!1)]:y,[]),p=u.reduce((y,x)=>x.selected?[...y,ge(x.id,!1)]:y,[]);l(h),g(p)},setNodeExtent:u=>{const{nodeLookup:a}=f();for(const[,l]of a){const g=yt(l.internals.positionAbsolute,u);a.set(l.id,{...l,internals:{...l.internals,positionAbsolute:g}})}d({nodeExtent:u})},panBy:u=>{const{transform:a,width:l,height:g,panZoom:h,translateExtent:p}=f();return Js({delta:u,panZoom:h,transform:a,translateExtent:p,width:l,height:g})},fitView:u=>{const{panZoom:a,width:l,height:g,minZoom:h,maxZoom:p,nodeLookup:y}=f();if(!a)return Promise.resolve(!1);const x=at(y,u);return lt({nodes:x,width:l,height:g,panZoom:a,minZoom:h,maxZoom:p},u)},fitViewSync:u=>{const{panZoom:a,width:l,height:g,minZoom:h,maxZoom:p,nodeLookup:y}=f();if(!a)return!1;const x=at(y,u);return lt({nodes:x,width:l,height:g,panZoom:a,minZoom:h,maxZoom:p},u),x.size>0},cancelConnection:()=>{d({connection:{...En}})},updateConnection:u=>{d({connection:u})},reset:()=>d({...pn()})}),Object.is);function sc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,fitView:i,nodeOrigin:c,children:d}){const[f]=v.useState(()=>oc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,nodeOrigin:c}));return E.jsx(Sr,{value:f,children:E.jsx(Wr,{children:d})})}function rc({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:c,nodeOrigin:d}){return v.useContext(Ke)?E.jsx(E.Fragment,{children:e}):E.jsx(sc,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:c,nodeOrigin:d,children:e})}const ic={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function cc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:c,onEdgeClick:d,onInit:f,onMove:u,onMoveStart:a,onMoveEnd:l,onConnect:g,onConnectStart:h,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:x,onNodeMouseEnter:S,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:_,onNodeDoubleClick:j,onNodeDragStart:M,onNodeDrag:A,onNodeDragStop:$,onNodesDelete:k,onEdgesDelete:B,onDelete:D,onSelectionChange:N,onSelectionDragStart:C,onSelectionDrag:P,onSelectionDragStop:H,onSelectionContextMenu:T,onSelectionStart:b,onSelectionEnd:I,onBeforeDelete:L,connectionMode:F,connectionLineType:Y=ue.Bezier,connectionLineStyle:G,connectionLineComponent:W,connectionLineContainerStyle:O,deleteKeyCode:X="Backspace",selectionKeyCode:U="Shift",selectionOnDrag:K=!1,selectionMode:z=Ie.Full,panActivationKeyCode:q="Space",multiSelectionKeyCode:Z=Fe()?"Meta":"Control",zoomActivationKeyCode:V=Fe()?"Meta":"Control",snapToGrid:J,snapGrid:ee,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:ae,nodesDraggable:qe,nodesConnectable:Qe,nodesFocusable:Je,nodeOrigin:Ee=qn,edgesFocusable:et,edgesReconnectable:be,elementsSelectable:ve=!0,defaultViewport:tt=Br,minZoom:Se=.5,maxZoom:Ne=2,translateExtent:Te=ze,preventScrolling:$o=!0,nodeExtent:kt,defaultMarkerColor:Ao="#b1b1b7",zoomOnScroll:Po=!0,zoomOnPinch:_o=!0,panOnScroll:Ho=!1,panOnScrollSpeed:jo=.5,panOnScrollMode:To=he.Free,zoomOnDoubleClick:Bo=!0,panOnDrag:Lo=!0,onPaneClick:Do,onPaneMouseEnter:Vo,onPaneMouseMove:zo,onPaneMouseLeave:Ro,onPaneScroll:Fo,onPaneContextMenu:Yo,paneClickDistance:$t=0,nodeClickDistance:Oo=0,children:Xo,onReconnect:Wo,onReconnectStart:Go,onReconnectEnd:Ko,onEdgeContextMenu:Zo,onEdgeDoubleClick:Uo,onEdgeMouseEnter:qo,onEdgeMouseMove:Qo,onEdgeMouseLeave:Jo,reconnectRadius:es=10,onNodesChange:ts,onEdgesChange:ns,noDragClassName:os="nodrag",noWheelClassName:ss="nowheel",noPanClassName:At="nopan",fitView:Pt,fitViewOptions:rs,connectOnClick:is,attributionPosition:cs,proOptions:as,defaultEdgeOptions:ls,elevateNodesOnSelect:ds,elevateEdgesOnSelect:us,disableKeyboardA11y:_t=!1,autoPanOnConnect:fs,autoPanOnNodeDrag:gs,autoPanSpeed:hs,connectionRadius:ps,isValidConnection:ms,onError:ys,style:xs,id:Ht,nodeDragThreshold:ws,viewport:Es,onViewportChange:bs,width:vs,height:Ss,colorMode:Ns="light",debug:Cs,...Ms},Is){const nt=Ht||"1",ks=zr(Ns);return E.jsx("div",{...Ms,style:{...xs,...ic},ref:Is,className:oe(["react-flow",s,ks]),"data-testid":"rf__wrapper",id:Ht,children:E.jsxs(rc,{nodes:e,edges:t,width:vs,height:Ss,fitView:Pt,nodeOrigin:Ee,children:[E.jsx(nc,{onInit:f,onNodeClick:c,onEdgeClick:d,onNodeMouseEnter:S,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:_,onNodeDoubleClick:j,nodeTypes:r,edgeTypes:i,connectionLineType:Y,connectionLineStyle:G,connectionLineComponent:W,connectionLineContainerStyle:O,selectionKeyCode:U,selectionOnDrag:K,selectionMode:z,deleteKeyCode:X,multiSelectionKeyCode:Z,panActivationKeyCode:q,zoomActivationKeyCode:V,onlyRenderVisibleElements:se,defaultViewport:tt,translateExtent:Te,minZoom:Se,maxZoom:Ne,preventScrolling:$o,zoomOnScroll:Po,zoomOnPinch:_o,zoomOnDoubleClick:Bo,panOnScroll:Ho,panOnScrollSpeed:jo,panOnScrollMode:To,panOnDrag:Lo,onPaneClick:Do,onPaneMouseEnter:Vo,onPaneMouseMove:zo,onPaneMouseLeave:Ro,onPaneScroll:Fo,onPaneContextMenu:Yo,paneClickDistance:$t,nodeClickDistance:Oo,onSelectionContextMenu:T,onSelectionStart:b,onSelectionEnd:I,onReconnect:Wo,onReconnectStart:Go,onReconnectEnd:Ko,onEdgeContextMenu:Zo,onEdgeDoubleClick:Uo,onEdgeMouseEnter:qo,onEdgeMouseMove:Qo,onEdgeMouseLeave:Jo,reconnectRadius:es,defaultMarkerColor:Ao,noDragClassName:os,noWheelClassName:ss,noPanClassName:At,rfId:nt,disableKeyboardA11y:_t,nodeExtent:kt,viewport:Es,onViewportChange:bs}),E.jsx(Vr,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:g,onConnectStart:h,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:x,nodesDraggable:qe,nodesConnectable:Qe,nodesFocusable:Je,edgesFocusable:et,edgesReconnectable:be,elementsSelectable:ve,elevateNodesOnSelect:ds,elevateEdgesOnSelect:us,minZoom:Se,maxZoom:Ne,nodeExtent:kt,onNodesChange:ts,onEdgesChange:ns,snapToGrid:J,snapGrid:ee,connectionMode:F,translateExtent:Te,connectOnClick:is,defaultEdgeOptions:ls,fitView:Pt,fitViewOptions:rs,onNodesDelete:k,onEdgesDelete:B,onDelete:D,onNodeDragStart:M,onNodeDrag:A,onNodeDragStop:$,onSelectionDrag:P,onSelectionDragStart:C,onSelectionDragStop:H,onMove:u,onMoveStart:a,onMoveEnd:l,noPanClassName:At,nodeOrigin:Ee,rfId:nt,autoPanOnConnect:fs,autoPanOnNodeDrag:gs,autoPanSpeed:hs,onError:ys,connectionRadius:ps,isValidConnection:ms,selectNodesOnDrag:ae,nodeDragThreshold:ws,onBeforeDelete:L,paneClickDistance:$t,debug:Cs}),E.jsx(Tr,{onSelectionChange:N}),Xo,E.jsx(Ar,{proOptions:as,position:cs}),E.jsx(kr,{rfId:nt,disableKeyboardA11y:_t})]})})}var Lc=to(cc);function Dc(e){const[t,n]=v.useState(e),o=v.useCallback(s=>n(r=>Jn(s,r)),[]);return[t,n,o]}function Vc(e){const[t,n]=v.useState(e),o=v.useCallback(s=>n(r=>eo(s,r)),[]);return[t,n,o]}function ac({dimensions:e,lineWidth:t,variant:n,className:o}){return E.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:oe(["react-flow__background-pattern",n,o])})}function lc({radius:e,className:t}){return E.jsx("circle",{cx:e,cy:e,r:e,className:oe(["react-flow__background-pattern","dots",t])})}var fe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(fe||(fe={}));const dc={[fe.Dots]:1,[fe.Lines]:1,[fe.Cross]:6},uc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Mo({id:e,variant:t=fe.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:c,style:d,className:f,patternClassName:u}){const a=v.useRef(null),{transform:l,patternId:g}=Q(uc,ne),h=o||dc[t],p=t===fe.Dots,y=t===fe.Cross,x=Array.isArray(n)?n:[n,n],S=[x[0]*l[2]||1,x[1]*l[2]||1],m=h*l[2],w=Array.isArray(r)?r:[r,r],_=[w[0]*l[2]||1,w[1]*l[2]||1],j=y?[m,m]:S,M=`${g}${e||""}`;return E.jsxs("svg",{className:oe(["react-flow__background",f]),style:{...d,...Ze,"--xy-background-color-props":c,"--xy-background-pattern-color-props":i},ref:a,"data-testid":"rf__background",children:[E.jsx("pattern",{id:M,x:l[0]%S[0],y:l[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`,children:p?E.jsx(lc,{radius:m/2,className:u}):E.jsx(ac,{dimensions:j,lineWidth:s,variant:t,className:u})}),E.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}Mo.displayName="Background";const zc=v.memo(Mo);function fc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:E.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function gc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:E.jsx("path",{d:"M0 0h32v4.2H0z"})})}function hc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:E.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function pc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:E.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function mc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:E.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Ve({children:e,className:t,...n}){return E.jsx("button",{type:"button",className:oe(["react-flow__controls-button",t]),...n,children:e})}const yc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Io({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:c,onInteractiveChange:d,className:f,children:u,position:a="bottom-left",orientation:l="vertical","aria-label":g="React Flow controls"}){const h=te(),{isInteractive:p,minZoomReached:y,maxZoomReached:x}=Q(yc,ne),{zoomIn:S,zoomOut:m,fitView:w}=Mt(),_=()=>{S(),r==null||r()},j=()=>{m(),i==null||i()},M=()=>{w(s),c==null||c()},A=()=>{h.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),d==null||d(!p)},$=l==="horizontal"?"horizontal":"vertical";return E.jsxs(Ct,{className:oe(["react-flow__controls",$,f]),position:a,style:e,"data-testid":"rf__controls","aria-label":g,children:[t&&E.jsxs(E.Fragment,{children:[E.jsx(Ve,{onClick:_,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x,children:E.jsx(fc,{})}),E.jsx(Ve,{onClick:j,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y,children:E.jsx(gc,{})})]}),n&&E.jsx(Ve,{className:"react-flow__controls-fitview",onClick:M,title:"fit view","aria-label":"fit view",children:E.jsx(hc,{})}),o&&E.jsx(Ve,{className:"react-flow__controls-interactive",onClick:A,title:"toggle interactivity","aria-label":"toggle interactivity",children:p?E.jsx(mc,{}):E.jsx(pc,{})}),u]})}Io.displayName="Controls";v.memo(Io);function xc({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:c,strokeWidth:d,className:f,borderRadius:u,shapeRendering:a,selected:l,onClick:g}){const{background:h,backgroundColor:p}=r||{},y=i||h||p;return E.jsx("rect",{className:oe(["react-flow__minimap-node",{selected:l},f]),x:t,y:n,rx:u,ry:u,width:o,height:s,style:{fill:y,stroke:c,strokeWidth:d},shapeRendering:a,onClick:g?x=>g(x,e):void 0})}const wc=v.memo(xc),Ec=e=>e.nodes.map(t=>t.id),ct=e=>e instanceof Function?e:()=>e;function bc({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=wc,onClick:i}){const c=Q(Ec,ne),d=ct(t),f=ct(e),u=ct(n),a=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return E.jsx(E.Fragment,{children:c.map(l=>E.jsx(Sc,{id:l,nodeColorFunc:d,nodeStrokeColorFunc:f,nodeClassNameFunc:u,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:a},l))})}function vc({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:c,onClick:d}){const{node:f,x:u,y:a}=Q(h=>{const p=h.nodeLookup.get(e),{x:y,y:x}=p.internals.positionAbsolute;return{node:p,x:y,y:x}},ne);if(!f||f.hidden||!$n(f))return null;const{width:l,height:g}=je(f);return E.jsx(c,{x:u,y:a,width:l,height:g,style:f.style,selected:!!f.selected,className:o(f),color:t(f),borderRadius:s,strokeColor:n(f),strokeWidth:r,shapeRendering:i,onClick:d,id:f.id})}const Sc=v.memo(vc);var Nc=v.memo(bc);const Cc=200,Mc=150,Ic=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?In(_e(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},kc="react-flow__minimap-desc";function ko({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:c,bgColor:d,maskColor:f,maskStrokeColor:u,maskStrokeWidth:a,position:l="bottom-right",onClick:g,onNodeClick:h,pannable:p=!1,zoomable:y=!1,ariaLabel:x="React Flow mini map",inversePan:S,zoomStep:m=10,offsetScale:w=5}){const _=te(),j=v.useRef(null),{boundingRect:M,viewBB:A,rfId:$,panZoom:k,translateExtent:B,flowWidth:D,flowHeight:N}=Q(Ic,ne),C=(e==null?void 0:e.width)??Cc,P=(e==null?void 0:e.height)??Mc,H=M.width/C,T=M.height/P,b=Math.max(H,T),I=b*C,L=b*P,F=w*b,Y=M.x-(I-M.width)/2-F,G=M.y-(L-M.height)/2-F,W=I+F*2,O=L+F*2,X=`${kc}-${$}`,U=v.useRef(0),K=v.useRef();U.current=b,v.useEffect(()=>{if(j.current&&k)return K.current=cr({domNode:j.current,panZoom:k,getTransform:()=>_.getState().transform,getViewScale:()=>U.current}),()=>{var Z;(Z=K.current)==null||Z.destroy()}},[k]),v.useEffect(()=>{var Z;(Z=K.current)==null||Z.update({translateExtent:B,width:D,height:N,inversePan:S,pannable:p,zoomStep:m,zoomable:y})},[p,y,S,m,B,D,N]);const z=g?Z=>{var ee;const[V,J]=((ee=K.current)==null?void 0:ee.pointer(Z))||[0,0];g(Z,{x:V,y:J})}:void 0,q=h?v.useCallback((Z,V)=>{const J=_.getState().nodeLookup.get(V);h(Z,J)},[]):void 0;return E.jsx(Ct,{position:l,style:{...e,"--xy-minimap-background-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof a=="number"?a*b:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:oe(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:E.jsxs("svg",{width:C,height:P,viewBox:`${Y} ${G} ${W} ${O}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:j,onClick:z,children:[x&&E.jsx("title",{id:X,children:x}),E.jsx(Nc,{onClick:q,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:c}),E.jsx("path",{className:"react-flow__minimap-mask",d:`M${Y-F},${G-F}h${W+F*2}v${O+F*2}h${-W-F*2}z
        M${A.x},${A.y}h${A.width}v${A.height}h${-A.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}ko.displayName="MiniMap";v.memo(ko);function $c({nodeId:e,position:t,variant:n=Me.Handle,className:o,style:s={},children:r,color:i,minWidth:c=10,minHeight:d=10,maxWidth:f=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:a=!1,shouldResize:l,onResizeStart:g,onResize:h,onResizeEnd:p}){const y=ro(),x=typeof e=="string"?e:y,S=te(),m=v.useRef(null),w=n===Me.Line?"right":"bottom-right",_=t??w,j=v.useRef(null);v.useEffect(()=>{if(!(!m.current||!x))return j.current||(j.current=vr({domNode:m.current,nodeId:x,getStoreItems:()=>{const{nodeLookup:k,transform:B,snapGrid:D,snapToGrid:N,nodeOrigin:C}=S.getState();return{nodeLookup:k,transform:B,snapGrid:D,snapToGrid:N,nodeOrigin:C}},onChange:(k,B)=>{const{triggerNodeChanges:D,nodeLookup:N,parentLookup:C,nodeOrigin:P}=S.getState(),H=[],T={x:k.x,y:k.y},b=N.get(x);if(b&&b.expandParent&&b.parentId){const I=b.origin??P,L=k.width??b.measured.width,F=k.height??b.measured.height,Y={id:b.id,parentId:b.parentId,rect:{width:L,height:F,...An({x:k.x??b.position.x,y:k.y??b.position.y},{width:L,height:F},b.parentId,N,I)}},G=Nt([Y],N,C,P);H.push(...G),T.x=k.x?Math.max(I[0]*L,k.x):void 0,T.y=k.y?Math.max(I[1]*F,k.y):void 0}if(T.x!==void 0&&T.y!==void 0){const I={id:x,type:"position",position:{...T}};H.push(I)}if(k.width!==void 0&&k.height!==void 0){const I={id:x,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:k.width,height:k.height}};H.push(I)}for(const I of B){const L={...I,type:"position"};H.push(L)}D(H)},onEnd:()=>{const k={id:x,type:"dimensions",resizing:!1};S.getState().triggerNodeChanges([k])}})),j.current.update({controlPosition:_,boundaries:{minWidth:c,minHeight:d,maxWidth:f,maxHeight:u},keepAspectRatio:a,onResizeStart:g,onResize:h,onResizeEnd:p,shouldResize:l}),()=>{var k;(k=j.current)==null||k.destroy()}},[_,c,d,f,u,a,g,h,p,l]);const M=_.split("-"),A=n===Me.Line?"borderColor":"backgroundColor",$=i?{...s,[A]:i}:s;return E.jsx("div",{className:oe(["react-flow__resize-control","nodrag",...M,n,o]),ref:m,style:$,children:r})}v.memo($c);export{zc as B,R as P,Vc as a,Ct as b,Lc as i,Dc as u};
